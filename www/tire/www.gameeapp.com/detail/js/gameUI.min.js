function showConsole(){"undefined"!=typeof console&&("undefined"!=typeof console.log?console.olog=console.log:console.olog=function(){}),console.log=function(e){console.olog(e),$("body").prepend('<p style="color: black">'+e+"</p>")},console.error=console.debug=console.info=console.log}function transformOverlay(e,a){var t=e.innerWidth(),n=e.innerHeight(),o=$("#canvasWrap").height(),i=$("#gameeFrameMobile").width(),s=i/6.8/100,r=o/5.36/100;a&&(s=Math.min(s,r),r=s);var l=Math.round((i-t)/2);Math.round((o-n)/2-50);e.css({"-webkit-transform":"translate("+l+"px, 0) scale3d("+s+", "+r+", 1)",transform:" translate("+l+"px, 0) scale3d("+s+", "+r+", 1)"})}function transformElement(e){var a=e.innerWidth(),n=(e.innerHeight(),$("#canvasWrap").height()),o=$("#gameeFrameMobile").width(),i=o/6.8/100,s=n/5.36/100,r=Math.round((o-a)/2);i=Math.min(i,s),s=i,e.css({"-webkit-transform":"translateX("+r+"px) scale3d("+i+", "+s+", 1)",transform:" translateX("+r+"px) scale3d("+i+", "+s+", 1)"})}function transformControls(e,a){var t=$("#controller"),n=e.innerWidth(),o=e.innerHeight(),i=(n-190)/2.7/100,s=o/2.7/100;a&&(i=Math.min(i,s),s=i),t.css({"-webkit-transform":"scale3d("+i+", "+s+", 1)",transform:"scale3d("+i+", "+s+", 1)"})}function transformControls2(e,a){var t=$("#restart"),n=$("#play"),o=$("#control-resume"),i=$(".gameLoading"),s=e.innerWidth(),r=e.innerHeight(),l=s/2/100,c=r/1.52/100;a&&(l=Math.min(l,c),c=l),l>=1&&(l=1,c=1),t.css({"-webkit-transform":"scale3d("+l+", "+c+", 1)",transform:"scale3d("+l+", "+c+", 1)"}),n.css({"-webkit-transform":"scale3d("+l+", "+c+", 1)",transform:"scale3d("+l+", "+c+", 1)"}),o.css({"-webkit-transform":"scale3d("+l+", "+c+", 1)",transform:"scale3d("+l+", "+c+", 1)"}),i.css({"-webkit-transform":"scale3d("+l+", "+c+", 1)",transform:"scale3d("+l+", "+c+", 1)"})}function resizeElements(e,a){var t=document.getElementById("gameeFrameMobile"),n=document.getElementById("canvasWrap"),o=document.getElementById("controls"),i=$(".overlay .inner"),s=$("#overlay-end"),r=$("#overlay-start"),l=$("#overlay-pause");i.css("max-width",e+"px"),s.css("height",a+"px"),r.css("height",a+"px"),l.css("height",a+"px"),t.width=e,t.height=e,t.style.width=e+"px",t.style.height=e+"px",n.style.height=e+"px",n.style.width=e+"px",o.style.height=a-e+"px",transformOverlay($("#overlay-start .transform"),!0),transformOverlay($("#overlay-end .transform"),!0),transformOverlay($("#overlay-pause .transform"),!0),transformElement($(".transform_score")),transformControls($("#controls"),!0),transformControls2($("#controls"),!0)}function preventDefault(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function preventDefaultForScrollKeys(e){return keys[e.keyCode]?(preventDefault(e),!1):void 0}function disableScroll(){window.addEventListener&&window.addEventListener("DOMMouseScroll",preventDefault,!1),window.onwheel=preventDefault,window.onmousewheel=document.onmousewheel=preventDefault,window.ontouchmove=preventDefault,document.onkeydown=preventDefaultForScrollKeys,document.ontouchmove=function(e){e.preventDefault()},document.addEventListener("touchmove",function(e){e.preventDefault()},!1)}function enableScroll(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",preventDefault,!1),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null,document.onkeydown=null,document.ontouchmove=null}var Game={},GameeBridge={},gameeUI={},timer,loc=window.localization;window.scrollerConfigHorizontal={scroll:"horizontal",lockOnDirection:"vertical"},window.scrollerConfigVertical={scroll:"vertical",lockOnDirection:"horizontal"},Pace.on("done",function(){gameeUI.gameLoaded(),resizeElements(window.innerWidth,window.innerHeight),$(".preloader").hide()}),"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1),disableScroll(),$(window).on("load",function(){var e=$(".gameFrame"),a=$("#gameeFrameMobile");navigator.userAgent.toLowerCase();a.attr("src",a.data("src")),Game=gameeGame(e[0]),Game2=gamee2Game(e[0],gameeUI),gameeUI.gameLoader.show(),gameeUI.playBtn.hide(),"tw"===webviewProvider&&$(".share-fb").remove(),"fb"===webviewProvider&&$(".share-tw").remove(),$(".cRankingsBtn").on("click",function(e){e.preventDefault(),gameeUI.fullRankings.show()}),$(".cRankingsBtn_close").on("click",function(e){e.preventDefault(),gameeUI.fullRankings.hide()}),$(".subscribeDialog_close").on("click",function(e){e.preventDefault(),gameeUI.subscribeDialog.hide(),gameeUI.sendMixpanelSubscribeAction("canceled")}),window.addEventListener("resize",function(){resizeElements(document.body.offsetWidth,document.body.offsetHeight)})}),window.addEventListener("orientationchange",function(){setTimeout(function(){resizeElements(document.body.offsetWidth,document.body.offsetHeight)},500)},!1);var mql=window.matchMedia("(orientation: portrait)");mql.matches||$("#alert").removeClass("hide").addClass("visible"),mql.addListener(function(e){e.matches?(enableScroll(),$("#alert").removeClass("visible").addClass("hide"),"paused"===gameeUI.currentState&&gameeUI.gameResume()):(disableScroll(),$("#alert").removeClass("hide").addClass("visible"),"playing"===gameeUI.currentState&&gameeUI.gamePause())}),GameeBridge={resume:function(){isGamee2()?Game2.resume():Game.resume()},start:function(){isGamee2()?Game2.start(!1):""},pause:function(){isGamee2()?Game2.pause():Game.pause()},restart:function(){isGamee2()?Game2.start(!1):Game.restart()}},gameeUI={currentState:"init",gameMode:"normal",user:null,anonymous_id:null,firstPlay:!0,gameHighscore:0,highscoreBeat:!1,playTime:0,score:0,myRank:null,myPhoto:null,gameplayCount:0,offerSubscriptionIn:3,gameeVer:1,onboardingComplete:null,allRankings:{},gameLoaded:function(){var e=$("html"),a=$(".gameFrame");e.addClass("loaded"),gameeUI.startOverlay.show(),a.focus(),$(".relatedGames").length&&(window.scroller4=new Scroller("#overlay-end .relatedGames .scrollArea",scrollerConfigHorizontal)),window.scroller5=new Scroller("#overlay-end .scrollerWrap",scrollerConfigVertical),"undefined"!=typeof kik&&kik.enabled&&kik.getUser(function(e){e?(gameeUI.user=e.username,gameeUI.getStats()):(gameeUI.user=null,kik.getAnonymousUser(function(e){gameeUI.anonymous_id=e}))}),(isTelegram()||isFacebook())&&gameeUI.getStats()},init:function(e,a){console.log("GameeJS - 2: init"),this.gameeVer=2,a(e)},gameReady:function(){console.log("GameeJS 2: ready"),gameeUI.gameLoader.hide(),gameeUI.playBtn.show()},requestSocial:function(){console.log("GameeJS 2: Socials requested")},saveState:function(){console.log("GameeJS 2: save state")},gameStart:function(){console.log("Game Start"),gameeUI.currentState="playing",gameeUI.timer.start(),gameeUI.updateScore(0),isGamee2()&&GameeBridge.start(!1)},gameBegin:function(){gameeUI.startOverlay.hide(),gameeUI.playBtn.hide(),gameeUI.controls.show(),isGamee2()&&gameeUI.gameStart()},gameOver:function(){var e=parseInt($(".totalScore").html());parseInt($(".highscore").html());gameeUI.gameplayCount++,isTelegram()&&gameGlobals.offerTelegramSubscription&&gameeUI.gameplayCount%gameeUI.offerSubscriptionIn===0&&gameeUI.subscribeDialog.show(),window.scroller5&&window.scroller5.scrollToTop(),$("#overlay-end .rankings, #overlay-end .ranks-wrap").removeClass("visible"),$(".share-tw").attr("href",gameeUI.game_tw_link(e)),gameeUI.currentState="gameOver",gameeUI.highscoreBeat=!1,gameeUI.onboardingComplete=!0,gameeUI.setScoreCustomText(""),gameeUI.overlay.show(),gameeUI.controls.hide(),$(".rankingsFailed").hide(),setTimeout(function(){gameeUI.restartBtn.show()},500),gameeUI.saveScore(gameeUI.score),gameeUI.updateHighscore(gameeUI.score),isTelegram()||gameeUI.sendMixpanel(window.gameeUI.score),ga("send",{hitType:"event",eventCategory:"Game",eventAction:"Played",eventLabel:""+gameGlobals.game_name}),gameeUI.timer.stop()},gameRestart:function(){GameeBridge.restart(),gameeUI.overlay.hide(),gameeUI.controls.show(),gameeUI.restartBtn.hide(),$("#overlay-end .rankings .item").css("opacity","0"),$(".ranks-wrap").removeClass("visible")},gamePause:function(){gameeUI.currentState="paused",GameeBridge.pause(),gameeUI.overlayPause.show(),gameeUI.controls.hide(),gameeUI.resumeBtn.show(),$(".your_score").addClass("paused"),gameeUI.timer.pause()},gameResume:function(){gameeUI.currentState="playing",gameeUI.overlayPause.hide(),gameeUI.timer.resume(),gameeUI.resumeBtn.hide(),gameeUI.controls.show(),$(".your_score").removeClass("paused"),GameeBridge.resume()},setController:function(e){gameeUI.gameLoader.hide(),gameeUI.playBtn.show()},checkFbStatus:function(e){gameeUI.myPhoto=e.photo},game_tw_link:function(e){return"https://twitter.com/share?text=Attention%20please,%20I%20have%20just%20scored%20"+e+"%20in%20"+gameGlobals.game_name+"!%20%40gameeapp%20&url="+gameGlobals.game_url},updateScore:function(e){var a=$(".totalScore");gameeUI.score=e,a.html(parseInt(e)),gameeUI.checkRankStatus(e)},updateOverall:function(e){gameGlobals.overallScore=e},updateHighscore:function(e){gameeUI.score>gameeUI.gameHighscore?(gameeUI.gameHighscore=e,gameeUI.firstPlay=!1,gameeUI.setScoreMessage(loc.newHighscore)):gameeUI.setScoreMessage(loc.youScored)},checkRankStatus:function(e){var i,a=gameeUI.gameHighscore,t=$(".rankStatus"),n=$(".inner",".rankStatus"),o='<div class="highscore"><span class="ic"></span> '+loc.highscoreBeat+"</div>",s=gameeUI.highscoreBeat,r=gameeUI.allRankings,l=r.length-1;e>a&&e>0&&s===!1&&gameeUI.firstPlay===!1&&(n.html(o),i=!0,gameeUI.highscoreBeat=!0),0!=Object.keys(r).length&&e>r[l].score&&(gameeUI.onboardingComplete?gameeUI.highscoreBeat===!0&&gameeUI.myRank!==r[l].rank&&(n.html('<div class="person"><img src="'+addProfilePicture(r[l].profile_picture)+'" class="pic" width="18" /> <span class="name">'+htmlspecialchars(r[l].username)+"</span> "+loc.beat+"</div>"),i=!0):(n.html('<div class="person"><img src="'+addProfilePicture(r[l].profile_picture)+'" class="pic" width="18" /> <span class="name">'+htmlspecialchars(r[l].username)+"</span> "+loc.beat+"</div>"),i=!0),r.splice(l)),i&&(t.show(),setTimeout(function(){t.hide(),i=!1},2200))},setScoreMessage:function(e){$(".you_scored_text").html(e)},setScoreCustomText:function(e){$(".custom_text",".your_score").html(e)},overlay:{show:function(){$("#canvasWrap").addClass("overlayVisible"),$("#overlay-end").addClass("visible"),$("#controls").addClass("visible")},hide:function(){$("#canvasWrap").removeClass("overlayVisible"),$("#overlay-end").removeClass("visible"),$("#controls").removeClass("visible")}},overlayPause:{show:function(){$("#canvasWrap").addClass("overlayVisible"),$("#overlay-pause").addClass("visible"),$("#controls").addClass("visible")},hide:function(){$("#canvasWrap").removeClass("overlayVisible"),$("#overlay-pause").removeClass("visible"),$("#controls").removeClass("visible")}},startOverlay:{show:function(){$("#canvasWrap").addClass("overlayVisible"),$("#overlay-start").addClass("visible"),$("#controls").addClass("visible")},hide:function(){$("#canvasWrap").removeClass("overlayVisible"),$("#overlay-start").removeClass("visible"),$("#controls").removeClass("visible"),$("#overlay-start .ranks-wrap").removeClass("visible")}},controls:{show:function(){$("#controller").addClass("visible")},hide:function(){$("#controller").removeClass("visible")}},loading:{show:function(e){e.show()},hide:function(e){e.hide()}},ranksLoading:{show:function(){$(".spinner",".rankings").show()},hide:function(){$(".spinner",".rankings").hide()}},shareLoading:{show:function(){$(".challenge-friends").prepend('<span class="spinner"></span>')},hide:function(){$(".spinner",".challenge-friends").remove()}},gameLoader:{show:function(){$(".gameLoading").remove(),$("#controls .cWrap").append('<div class="gameLoading"><div class="icn"></div></div>'),$("#overlay-start .inner").append('<div class="gameLoading fs-loading"><div class="icn"></div></div>')},hide:function(){$(".gameLoading").remove(),$("#overlay-start .rankings").addClass("loaded").removeClass("loading")}},restartBtn:{show:function(){$(".cLayout.restart, .control-fs-restart").addClass("visible")},hide:function(){$(".cLayout.restart, .control-fs-restart").removeClass("visible")}},playBtn:{show:function(){$(".cLayout.play, .control-fs-play").addClass("visible")},hide:function(){$(".cLayout.play, .control-fs-play").removeClass("visible")}},resumeBtn:{show:function(){$(".cLayout.resume, .control-fs-resume").addClass("visible")},hide:function(){$(".cLayout.resume, .control-fs-resume").removeClass("visible")}},fullRankings:{show:function(){$("#overlay-standing .in").css("max-height",document.body.offsetHeight-130+"px"),$("#gameeMobile #overlay-standing").addClass("visible"),gameeUI.getFullRankings()},hide:function(){disableScroll(),$("#gameeMobile #overlay-standing").removeClass("visible")}},subscribeDialog:{show:function(){$("#gameeMobile #overlay-subscribe").addClass("visible")},hide:function(){$("#gameeMobile #overlay-subscribe").removeClass("visible")}},timer:{start:function(){timer=setInterval(function(){++gameeUI.playTime},1e3)},pause:function(){clearTimeout(timer)},resume:function(){timer=setInterval(function(){++gameeUI.playTime},1e3)},stop:function(){clearTimeout(timer),gameeUI.playTime=0}},sendMixpanel:function(e){mixpanel.track("Game Played",{"game name":gameGlobals.game_name,"game genre":gameGlobals.game_genre,"game score":e,"game play time":gameeUI.playTime,source:gameGlobals.game_source,"web version":"mobile",mode:gameeUI.gameMode})},sendMixpanelShare:function(e,a,t,n){mixpanel.track("Web Game Shared",{type:e,screen:a,"web version":t,"game name":gameGlobals.game_name,"button variant":n})},sendMixpanelSubscribeAction:function(e){mixpanel.track("telegram Subscribe Dialog Shown",{action:e})},setGameOverRankings:function(e){var a=e.result.ranking,t=0!=Object.keys(a.beforeMe).length?a.beforeMe:"",n=Object.keys(t).map(function(e){return t[e]}),o=n.reverse(),i=0!=Object.keys(a.afterMe).length?a.afterMe:"",s=Object.keys(i).map(function(e){return i[e]}),r=s.reverse(),l=a.me,c="",m="",d="",u="",g="",p="",f="",v=Object.keys(t).length+Object.keys(i).length+1;if($("#overlay-end .rankings .items .item, #overlay-pause .rankings .items .item").remove(),0!=Object.keys(a.afterMe).length)for(var h in r)m+='<div class="item"><div class="pic_wrap"><img src="'+addProfilePicture(r[h].profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>'+formatUsername(r[h].username)+'</span></div><div class="points">'+r[h].score+"</div></div>";if(0!=Object.keys(a.me).length&&(meRankTpl='<div class="item me"><div class="pic_wrap"><img src="'+addProfilePicture(l.profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>Me</span></div><div class="points">'+(l.score?l.score:"-")+"</div></div>"),2>=v?($(".rankings .headline").html(loc.youVsFriend),$(".rankings .headline").addClass("text-center"),1===v&&(d='<div class="item vs">vs</div>'),0===Object.keys(a.beforeMe).length&&1===Object.keys(a.afterMe).length&&(u='<div class="item vs">vs</div>',p=meRankTpl,meRankTpl=""),1===Object.keys(a.beforeMe).length&&0===Object.keys(a.afterMe).length&&(g='<div class="item vs">vs</div>')):$(".rankings .headline").html(loc.leaderboards),(1===v||3===v)&&(f+='<div class="item friend challenge-friends '+onPlatform()+'"><div class="pic_wrap"><img src="../detail/assets/svg/find-friends-plus.svg" class="pic" /></div><div class="username"><span>Friend</span></div><div class="points">-</div></div>'),0!=Object.keys(a.beforeMe).length)for(var h in o)c+='<div class="item"><div class="pic_wrap"><img src="'+addProfilePicture(o[h].profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>'+formatUsername(o[h].username)+'</span></div><div class="points">'+o[h].score+"</div></div>";window.scroller5&&(window.scroller5.destroy(),$("#overlay-end .scrollerWrap").removeClass("scroller-wrapper scroll-vertical"),$("#overlay-end .scrollerIn").removeClass("scroller"),$("#overlay-end .scrollerIn").removeAttr("style")),window.scroller2&&window.scroller2.destroy(),window.scroller3&&window.scroller3.destroy(),$("#overlay-end .rankings .items, #overlay-pause .rankings .items").append(p+u+m+meRankTpl+g+c+d+f),v>4&&(window.scroller2=new Scroller("#overlay-end .rankings .scrollArea",scrollerConfigHorizontal),window.scroller3=new Scroller("#overlay-pause .rankings .scrollArea",scrollerConfigHorizontal)),window.scroller5=new Scroller("#overlay-end .scrollerWrap",scrollerConfigVertical),window.scroller5._startMoveRAF(0),window.scroller5.scrollToTop(),window.dispatchEvent(new Event("resize"))},setStartRankings:function(e){var a=e.result.ranking,t=0!=Object.keys(a.beforeMe).length?a.beforeMe:"",n=Object.keys(t).map(function(e){return t[e]}),o=n.reverse(),i=0!=Object.keys(a.afterMe).length?a.afterMe:"",s=Object.keys(i).map(function(e){return i[e]}),r=s.reverse(),l=a.me,c=a.onboardingComplete,m="",d="",u="",g="",p="",f="",v="",h="",y=Object.keys(t).length+Object.keys(i).length+1;if(gameeUI.onboardingComplete=c,y>3&&$(".cRankingsBtn").css("display","inline-block"),$("#overlay-start .rankings .items .item, #overlay-pause .rankings .items .item").remove(),0!=Object.keys(a.afterMe).length)for(var w in r)d+='<div class="item"><div class="pic_wrap"><img src="'+addProfilePicture(r[w].profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>'+formatUsername(r[w].username)+'</span></div><div class="points">'+r[w].score+"</div></div>";if(0!=Object.keys(a.me).length){var k;l.score>0&&($(".userHighscore").html(parseInt(l.score)),gameeUI.gameHighscore=parseInt(l.score),gameeUI.firstPlay=!1),isFacebook()?k=gameeUI.myPhoto:l.profile_picture&&(k=l.profile_picture),meRankTpl='<div class="item me"><div class="pic_wrap"><img src="'+addProfilePicture(k)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>Me</span></div><div class="points">'+(l.score?l.score:"-")+"</div></div>"}if(2>=y?($(".rankings .headline").html(loc.youVsFriend),$(".rankings .headline").addClass("text-center"),1===y&&(u='<div class="item vs">vs</div>'),0===Object.keys(a.beforeMe).length&&1===Object.keys(a.afterMe).length&&(p='<div class="item vs">vs</div>',f=meRankTpl,meRankTpl=""),1===Object.keys(a.beforeMe).length&&0===Object.keys(a.afterMe).length&&(g='<div class="item vs">vs</div>')):$(".rankings .headline").html(loc.leaderboards),(1===y||3===y)&&(v+='<div class="item friend challenge-friends '+onPlatform()+'"><div class="pic_wrap"><img src="../detail/assets/svg/find-friends-plus.svg" class="pic" /></div><div class="username"><span>Friend</span></div><div class="points">-</div></div>'),0!=Object.keys(a.beforeMe).length){c===!1&&(h="steve");for(var w in o)m+='<div class="item '+h+'"><div class="pic_wrap"><img src="'+addProfilePicture(o[w].profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>'+formatUsername(o[w].username)+'</span></div><div class="points">'+o[w].score+"</div></div>"}$("#overlay-start .rankings .items, #overlay-pause .rankings .items").append(f+p+d+meRankTpl+g+m+u+v),y>4&&(window.scroller1=new Scroller("#overlay-start .rankings .scrollArea",scrollerConfigHorizontal),window.scroller3=new Scroller("#overlay-pause .rankings .scrollArea",scrollerConfigHorizontal)),window.scroller6||(window.scroller6=new Scroller("#overlay-start .scrollerWrap",scrollerConfigVertical)),transformOverlay($("#overlay-start .transform"),!0),window.dispatchEvent(new Event("resize"))},saveScore:function(e){var a=window.location.pathname,t=gameeUI.user,n=(new Date).getTime(),o=$("#dataId").data(),i=CryptoJS.AES.encrypt(JSON.stringify({score:e,timestamp:n}),o.id,{format:CryptoJSAesJson}).toString(),s={score:e,url:a,play_time:gameeUI.playTime,hash:i,username:t,anonymous_id:gameeUI.anonymous_id};if(isFacebook()){var r=FacebookUserData.getUserData();s.app_scoped_user_id=r.app_scoped_user_id,s.user_id=r.user_id}gameeUI.sendScoreData(s)},sendScoreData:function(e){var a=JSON.stringify(e),t=$(".rankingsFailed"),n=getBotsApiUrl()+"/set-web-score-qkfnsog26w7173c9pk7whg0iau7zwhdkfd7ft3tn";gameeUI.ranksLoading.show(),$("#overlay-end .rankings .items .item, #overlay-pause .rankings .items .item").remove(),$("#overlay-end .rankings, #overlay-end .ranks-wrap").addClass("visible"),$.ajax({type:"POST",url:n,data:a,success:function(e){gameeUI.ranksLoading.hide(),(isTelegram()||isKik()||isFacebook())&&(isEmpty(e.result.ranking)||(gameeUI.setGameOverRankings(e),gameeUI.saveRankingsToObject(e))),$(".this-share").addClass("visible")},error:function(e,a){gameeUI.ranksLoading.hide(),t.show(),window.scroller5||(window.scroller5=new Scroller("#overlay-end .scrollerWrap",scrollerConfigVertical))},timeout:1e4,dataType:"json",crossDomain:!0})},setFullRankings:function(e){var a=e.result.ranking,t=null===e.result.myRank?"0":e.result.myRank;e.result.membersCount;if(Object.keys(a).length>0){for(var o in a){var i=a[o].rank===t?"me":"",r=a[o].profile_picture;$("#overlay-standing .items").append('<div class="row '+i+'"><div class="line"><div class="number">'+a[o].rank+'.</div><div class="pic_wrap"><div class="pic_in"><img src="'+addProfilePicture(r)+'" class="pic" onerror="this.src=\'../detail/assets/png/avatar-placeholder.png\';" /></div></div><div class="name"><span>'+htmlspecialchars(a[o].username)+'</span></div><div class="points">'+a[o].score+"</div></div></div>")}window.fullRankScroller?window.fullRankScroller.scrollToTop():window.fullRankScroller=new Scroller("#overlay-standing .area",scrollerConfigVertical)}},saveRankingsToObject:function(e){var a=e.result.ranking.beforeMe,t=Object.keys(a).map(function(e){return a[e]}),n=null===e.result.ranking.me.rank?"0":e.result.ranking.me.rank;Object.keys(a).length>0&&(gameeUI.allRankings=t,gameeUI.myRank=n)},getFullRankings:function(){var e=window.location.pathname,a=gameeUI.user,t=getBotsApiUrl()+"/api/game-url-ranking",n=$("#overlay-standing .spinner"),o={url:escape(e)};null!=gameeUI.anonymous_id&&(a=""),isFacebook()&&(o.facebook_user_id=FacebookUserData.getUserData().app_scoped_user_id),isKik()&&(o.username=a),$("#overlay-standing .items .row").remove(),gameeUI.loading.show(n),$.ajax({type:"GET",url:t,data:o,xhrFields:{withCredentials:!0},success:function(e){setTimeout(function(){gameeUI.loading.hide(n),gameeUI.setFullRankings(e)},500)},beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa("web-api:1k2tnlowfvzfjursfhf523fuenc1guzwxfq8jgc8"))},error:function(e,a){gameeUI.loading.hide(n)},timeout:1e4,dataType:"json",crossDomain:!0})},getStats:function(){var e=window.location.pathname,a=gameeUI.user;gameeUI.ranksLoading.show();var t={url:escape(e)};if(null!=gameeUI.anonymous_id&&(a=""),isKik()&&(t.username=a),isFacebook()){var n=this;FacebookUserData.addAfterLoginCallback(function(){t.facebook_user_id=FacebookUserData.getUserData().app_scoped_user_id,n.checkFbStatus(FacebookUserData.getUserData()),FacebookUserData.isLoggedIn()?n.getSurroundingRankings(t):($("#overlay-start .ranks-wrap").addClass("visible"),$(".fb-connect").show(),$("#overlay-start .rankings, #overlay-start .this-share").hide())})}else this.getSurroundingRankings(t)},getSurroundingRankings:function(e){var a=getBotsApiUrl()+"/api/game-url-surrounding-ranking",t=$(".rankingsFailed");gameeUI.ranksLoading.show(),$("#overlay-start .rankings, #overlay-pause .rankings, #overlay-start .ranks-wrap").addClass("visible"),$.ajax({type:"GET",url:a,data:e,success:function(e){gameeUI.ranksLoading.hide(),isEmpty(e.result.ranking)||(gameeUI.setStartRankings(e),(isFacebook()||isTelegram()||isKik())&&gameeUI.saveRankingsToObject(e))},xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa("web-api:1k2tnlowfvzfjursfhf523fuenc1guzwxfq8jgc8"))},error:function(e,a){gameeUI.ranksLoading.hide(),t.show(),window.scroller6||(window.scroller6=new Scroller("#overlay-start .scrollerWrap",scrollerConfigVertical))},timeout:1e4,crossDomain:!0})},kikPickFriends:function(){kik.pickUsers(function(e){e&&e.forEach(function(e){kik.send(e.username,{title:"Let's play this game! ;)",text:"... "+gameGlobals.game_name+" "+window.location.href,pic:gameGlobals.game_img})})})}};var keys={37:1,38:1,39:1,40:1},webviewProvider=function(){return/\/FBIOS/i.test(navigator.userAgent)===!0?"fb":/Twitter for/i.test(navigator.userAgent)===!0?"tw":/\/\/t.co\//i.test(document.referrer)===!0?"tw":null}();$(".re-request-friends-permission").on("click",function(e){e.preventDefault(),FacebookUserData.forceRelogin()}),$(".action-fb-connect").on("click",function(e){e.preventDefault(),FacebookUserData.forceConnect()}),$(".pauseGame").on("click",function(){gameeUI.gamePause()}),$("#control-restart, .control-fs-restart").on("click touchend",function(e){e.preventDefault(),gameeUI.gameRestart()}),$("#control-play, .control-fs-play").on("click touchend",function(e){e.preventDefault(),gameeUI.gameBegin()}),$("#control-resume, .control-fs-resume").on("click",function(e){gameeUI.gameResume()}),$(".this-share a").on("click",function(e){var a=$(this).data("screen"),t=$(this).data("type"),n=$(this).data("version"),o=1;gameeUI.sendMixpanelShare(t,a,n,o)}),$(".relatedGames .headline, .noTouchScrollUp").on("click",function(e){e.preventDefault(),window.scroller5.scrollToBottom(150)}),$(document).on("click",".challenge-friends",function(e){gameeUI.shareLoading.show(),setTimeout(function(){gameeUI.shareLoading.hide()},2500)}),$(document).on("click",".challenge-friends.on-telegram, .challenge-btn.on-telegram",function(e){TelegramGameProxy.shareScore()}),$(document).on("click",".challenge-friends.on-kik, .challenge-btn.on-kik",function(e){gameeUI.kikPickFriends()}),$(document).on("click",".challenge-friends.on-fb, .challenge-btn.on-fb",function(e){var a=$("body").attr("data-bot-deep-link-base"),t={type:"game",code:gameGlobals.game_code,name:FacebookUserData.getUserData().facebookName,score:gameeUI.gameHighscore,gender:FacebookUserData.getUserData().gender,pageScopedUserId:FacebookUserData.getUserData().user_id,appScopedUserId:FacebookUserData.getUserData().app_scoped_user_id},n=a+"?ref="+encodeURIComponent(JSON.stringify(t)),o={attachment:{type:"template",payload:{template_type:"generic",elements:[{title:"Can you beat me in "+gameGlobals.game_name,image_url:gameGlobals.game_img,subtitle:"My score is: "+t.score,default_action:{type:"web_url",url:n},buttons:[{type:"web_url",url:n,title:"▶ Play "+gameGlobals.game_name}]}]}}};MessengerExtensions.beginShareFlow(function(){},function(e,a){var t=$("body").data("facebook-bot-app-id"),n=gameGlobals.game_fullUrl;window.open("fb-messenger://share?link="+encodeURIComponent(n)+"&app_id="+encodeURIComponent(t))},o,"broadcast")}),document.getElementById("control-oneButton").addEventListener("touchstart",function(e){Game.buttonButtonDown()},!1),document.getElementById("control-oneButton").addEventListener("touchend",function(e){setTimeout(function(){Game.buttonButtonUp()},20)},!1),document.getElementById("control-arrow-up").addEventListener("touchstart",function(e){Game.upButtonDown()},!1),document.getElementById("control-arrow-up").addEventListener("touchend",function(e){setTimeout(function(){Game.upButtonUp()},20)},!1),document.getElementById("control-arrow-down").addEventListener("touchstart",function(e){Game.downButtonDown()},!1),document.getElementById("control-arrow-down").addEventListener("touchend",function(e){setTimeout(function(){Game.downButtonUp()},20)},!1),document.getElementById("control-arrow-left").addEventListener("touchstart",function(e){Game.leftButtonDown()},!1),document.getElementById("control-arrow-left").addEventListener("touchend",function(e){setTimeout(function(){Game.leftButtonUp()},20)},!1),document.getElementById("control-arrow-right").addEventListener("touchstart",function(e){Game.rightButtonDown()},!1),document.getElementById("control-arrow-right").addEventListener("touchend",function(e){setTimeout(function(){Game.rightButtonUp()},20)},!1),document.getElementById("control-buttonA").addEventListener("touchstart",function(e){Game.aButtonDown()},!1),document.getElementById("control-buttonA").addEventListener("touchend",function(e){setTimeout(function(){Game.aButtonUp()},20)},!1),document.getElementById("control-buttonB").addEventListener("touchstart",function(e){Game.bButtonDown()},!1),document.getElementById("control-buttonB").addEventListener("touchend",function(e){setTimeout(function(){Game.bButtonUp()},20)},!1),$("#overlay-start .btn-reload").on("click",function(e){var a=$(".rankingsFailed");a.hide(),gameeUI.ranksLoading.show(),gameeUI.getStats(),e.preventDefault()}),$("#overlay-end .btn-reload").on("click",function(e){var a=$(".rankingsFailed");a.hide(),gameeUI.ranksLoading.show(),gameeUI.saveScore(gameeUI.score),e.preventDefault()}),$(".subscribe-btn.on-telegram").on("click",function(e){gameeUI.subscribeDialog.hide(),gameeUI.sendMixpanelSubscribeAction("clicked")});