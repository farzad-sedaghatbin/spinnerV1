(function(w){"use strict";w||(w=window);var NS="__S";if(typeof w[NS]==="undefined"){w[NS]={}}NS=w[NS];NS.plugins={};NS.Logger={log:function(){}}})(window);(function(w){"use strict";w||(w=window);if(!Array.prototype.forEach){Array.prototype.forEach=function(fun){if(this===void 0||this===null){throw new TypeError}var t=Object(this),len=t.length>>>0;if(typeof fun!=="function"){throw new TypeError}var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++){if(i in t){fun.call(thisArg,t[i],i,t)}}}}var SCROLLER=w.__S||(w.__S={}),DOCUMENT_STYLE=w.document.documentElement.style,VENDORS=["webkit","Moz","ms"],NAV=w.navigator,UA=NAV&&NAV.userAgent,WP=UA&&UA.match(/Windows Phone (?:OS[ \/])?(\d+)\.(\d+)/),IOS=UA&&UA.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),ANDROID=UA&&UA.match(/Android/),IS_WP=!!WP,IS_IOS=!IS_WP&&!!IOS,IS_ANDROID=!IS_WP&&!!ANDROID,IOS_SCROLL=IOS&&IOS[1]>=8,supportTransition=false,supportTransform=false,property,prefix,i;if("transition"in DOCUMENT_STYLE){supportTransition=true;prefix=""}else{for(i=0;i<VENDORS.length;i++){property=VENDORS[i]+"Transition";if(DOCUMENT_STYLE[property]!=="undefined"){supportTransition=true;prefix=VENDORS[i]}}}if(typeof DOCUMENT_STYLE.transform!=="undefined"){supportTransform=true}else{for(i=0;i<VENDORS.length;i++){property=VENDORS[i]+"Transform";if(typeof DOCUMENT_STYLE[property]!=="undefined"){supportTransform=true;prefix=VENDORS[i]}}}SCROLLER.support={prefix:prefix,transition:supportTransition,transform:supportTransform,matrix:!!(w.WebKitCSSMatrix||w.MSCSSMatrix),touch:"ontouchstart"in w,pointers:w.navigator.pointerEnabled,msPointers:w.navigator.msPointerEnabled,touchScroll:IOS_SCROLL,isWP:IS_WP,isIOS:IS_IOS,isAndroid:IS_ANDROID}})(window);(function(w){"use strict";w||(w=window);var SCROLLER=w.__S||(w.__S={}),SUPPORT=SCROLLER.support,prefix=SUPPORT&&SUPPORT.prefix,props={};function getTotalWidthOrHeight(name,el){var cssExpand=["Top","Right","Bottom","Left"],elStyles=w.getComputedStyle(el),isWidth=name==="width",attrCount=isWidth?1:0,val=0;for(;attrCount<4;attrCount+=2){val+=parseInt(elStyles["margin"+cssExpand[attrCount]],10)}return val+(isWidth?el.offsetWidth:el.offsetHeight)}if(!SUPPORT){w.console.log("Scroller Dependency error! browser support detection needed");return}if(SUPPORT.transition&&SUPPORT.transform){if(prefix!==""){props={transform:prefix+"Transform",transition:prefix+"Transition",transitionProperty:prefix+"TransitionProperty",transitionTimingFunction:prefix+"TransitionTimingFunction",transitionDuration:prefix+"TransitionDuration",transformOrigin:prefix+"TransformOrigin",boxSizing:prefix+"BoxSizing",matrix:w.WebKitCSSMatrix||w.MSCSSMatrix}}else{props={transform:"transform",transition:"transition",transitionProperty:"transitionProperty",transitionTimingFunction:"transitionTimingFunction",transitionDuration:"transitionDuration",transformOrigin:"transformOrigin",boxSizing:"boxSizing",matrix:w.WebKitCSSMatrix||w.MSCSSMatrix}}}props.getHeight=function(el){return getTotalWidthOrHeight("height",el)};props.getWidth=function(el){return getTotalWidthOrHeight("width",el)};SCROLLER.styles=props})(window);(function(w){"use strict";w||(w=window);var SCROLLER=w.__S||(w.__S={}),HELPERS={simpleMerge:function(obj1,obj2){var obj3={},attrname;for(attrname in obj1){if(obj1.hasOwnProperty(attrname)){obj3[attrname]=obj1[attrname]}}for(attrname in obj2){if(obj2.hasOwnProperty(attrname)){obj3[attrname]=obj2[attrname]}}return obj3},parseDOM:function(data){var div;if(data&&data.length){if(typeof data==="string"){div=w.document.createElement("div");div.innerHTML=data;return Array.prototype.slice.call(div.children,0)}else{return Array.prototype.slice.call(data,0)}}},bind:function(el,type,fn,capture){el.addEventListener(type,fn,!!capture)},unbind:function(el,type,fn,capture){el.removeEventListener(type,fn,!!capture)}};SCROLLER.helpers=HELPERS})(window);(function(w){"use strict";w||(w=window);var lastTime=0,caf="CancelAnimationFrame",vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!w.requestAnimationFrame;++x){w.requestAnimationFrame=w[vendors[x]+"RequestAnimationFrame"];w.cancelAnimationFrame=w[vendors[x]+caf]||w[vendors[x]+caf]}if(!w.requestAnimationFrame){w.requestAnimationFrame=function(callback,element){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=w.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id}}if(!w.cancelAnimationFrame){w.cancelAnimationFrame=function(id){w.clearTimeout(id)}}})(window);(function(w){w||(w=window);if(!(typeof w.Element==="undefined"||"classList"in document.documentElement)){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(obj,start){for(var i=start||0,j=this.length;i<j;i++){if(this[i]===obj){return i}}return-1}}var prototype=Array.prototype,indexOf=prototype.indexOf,slice=prototype.slice,push=prototype.push,splice=prototype.splice,join=prototype.join;function DOMTokenList(el){this._element=el;if(el.className!=this._classCache){this._classCache=el.className;if(!this._classCache)return;var classes=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/),i;for(i=0;i<classes.length;i++){push.call(this,classes[i])}}}function setToClassName(el,classes){el.className=classes.join(" ")}DOMTokenList.prototype={add:function(token){if(this.contains(token))return;push.call(this,token);setToClassName(this._element,slice.call(this,0))},contains:function(token){return indexOf.call(this,token)!==-1},item:function(index){return this[index]||null},remove:function(token){var i=indexOf.call(this,token);if(i===-1){return}splice.call(this,i,1);setToClassName(this._element,slice.call(this,0))},toString:function(){return join.call(this," ")},toggle:function(token){if(!this.contains(token)){this.add(token)}else{this.remove(token)}return this.contains(token)}};window.DOMTokenList=DOMTokenList;function defineElementGetter(obj,prop,getter){if(Object.defineProperty){Object.defineProperty(obj,prop,{get:getter})}else{obj.__defineGetter__(prop,getter)}}defineElementGetter(Element.prototype,"classList",function(){return new DOMTokenList(this)})}})(window);(function(w){"use strict";w||(w=window);var SCROLLER=w.__S||(w.__S={}),ITERATIONS=4;function KeySpline(mX1,mY1,mX2,mY2){var CubicBezierSpline;function A(aA1,aA2){return 1-3*aA2+3*aA1}function B(aA1,aA2){return 3*aA2-6*aA1}function C(aA1){return 3*aA1}function CalcBezier(aT,aA1,aA2){return((A(aA1,aA2)*aT+B(aA1,aA2))*aT+C(aA1))*aT}function GetSlope(aT,aA1,aA2){return 3*A(aA1,aA2)*aT*aT+2*B(aA1,aA2)*aT+C(aA1)}function GetTForX(aX){var aGuessT=aX,iterations=ITERATIONS,currentSlope,currentX,i;for(i=0;i<iterations;i++){currentSlope=GetSlope(aGuessT,mX1,mX2);if(currentSlope===0){return aGuessT}currentX=CalcBezier(aGuessT,mX1,mX2)-aX;aGuessT-=currentX/currentSlope}return aGuessT}CubicBezierSpline=function(aX){if(mX1===mY1&&mX2===mY2){return aX}return CalcBezier(GetTForX(aX),mY1,mY2)};CubicBezierSpline.toString=function(){return"cubic-bezier("+mX1+", "+mY1+", "+mX2+", "+mY2+")"};return CubicBezierSpline}SCROLLER.CubicBezier=KeySpline})(window);(function(w){"use strict";w||(w=window);var SCROLLER=w.__S||(w.__S={}),PLUGINS=SCROLLER.plugins||(SCROLLER.plugins={}),Logger=SCROLLER.Logger;function Endless(){}Endless.prototype={init:function(){this.endless=true},_itemsLeft:function(){return true},_mod:function(index){var n=this.items.length;return(index%n+n)%n},_setActiveOffset:function(){this.activeOffset=(this.scrollVertical?this.wrapperHeight:this.wrapperWidth)-5},_momentum:function(current,start,duration,lowerMargin,wrapperSize){var velocity=this._getVelocity(current,start,duration),momentum=this._computeMomentum(velocity,current);return momentum},_resetPosition:function(){return false},_isOutOfScroll:function(){return false},_updateAllowed:function(current){return this._isScrolling||Math.abs(current.dist)>5},_getBoundaries:function(pos,size){return{top:-pos-size,bottom:-pos+size+this.activeOffset}},_recycleEnableTest:function(){return true},_initializePositions:function(){var items=this.items,itemsSize=items.length,positioned=this.surfacesPositioned,sizeNotCover=true,sizeNeeded=this.wrapperSize+this.activeOffset,heightSum=0,i,j,item,surface,height;for(i=0;i<itemsSize&&sizeNotCover;i++){item=items[i];surface=this._getAvailableSurface();heightSum+=this._attachItemInSurface(item,surface,{index:i,offset:heightSum});sizeNotCover=heightSum<sizeNeeded;positioned[i]=surface}sizeNotCover=true;heightSum=0;sizeNeeded=this.activeOffset;if(i===itemsSize||!sizeNotCover){Logger.log("[WARNING - SCROLLER ENDLESS PLUGIN] - "+"Items are not sufficient to fulfill all scrollable area")}for(j=itemsSize-1;j>=i&&sizeNotCover;j--){item=items[j];surface=this._getAvailableSurface();heightSum+=this._attachItemInSurface(item,surface,{index:j,offset:positioned[0].offset,preCalculateSize:true});positioned.unshift(surface);sizeNotCover=heightSum<sizeNeeded}this._setInfiniteScrollerSize()}};PLUGINS.Endless=Endless})(window);(function(w){"use strict";w||(w=window);var SCROLLER=w.__S||(w.__S={}),PLUGINS=SCROLLER.plugins||(SCROLLER.plugins={}),SUPPORT=SCROLLER.support,STYLES=SCROLLER.styles,HELPERS=SCROLLER.helpers,RAF=w.requestAnimationFrame,Logger=SCROLLER.Logger,INITIAL_SURFACES=10;function SurfaceManager(){}SurfaceManager.matrixTransform=function(x,y){return"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+x+","+y+", 0, 1)"};SurfaceManager.translateTransform=function(x,y){return"translate3d("+x+"px,"+y+"px, 0)"};SurfaceManager.prototype={init:function(){this.surfacesPositioned=[];this.surfacesPool=[];this.items=[];this.on("_initialize",this._initializeSurfaceManager);this.on("_update",this._updateSurfaceManager);this.on("destroy",this._destroySurfaceManager)},_initializeSurfaceManager:function(){this._initTransformFunction();this._bootstrapItems();this._initializeSurfaces();this._setActiveOffset();this._initializePositions();this._setInfiniteScrollerSize();this._setWrapperState()},_initTransformFunction:function(){this._transformFnc=this.opts.useNativeScroller?SurfaceManager.translateTransform:SurfaceManager.matrixTransform},_setWrapperState:function(){if(this.opts.useNativeScroller){var ptr=this.opts.pullToRefresh&&this.opts.pullToRefreshConfig;if(ptr&&ptr.type==="native"){this.scrollTo(0,-this.getPTRSize())}}},_destroySurfaceManager:function(){var docfrag=w.document.createDocumentFragment();this.items.forEach(function(i){docfrag.appendChild(i.dom)});this.scroller.innerHTML="";this.scroller.appendChild(docfrag);this.items=[];this.surfacesPool=[];this.surfacesPositioned=[]},_bootstrapItems:function(){var ptr=this.opts.pullToRefresh&&this.opts.pullToRefreshConfig,skipPtr=ptr&&ptr.type!=="ios"?1:0,domItems=Array.prototype.slice.call(this.scroller.children,skipPtr),size=domItems.length,items=[],item,itemStyle,i;if(size){for(i=0;i<size;i++){item=domItems[i];items[i]={dom:item};this.scroller.removeChild(item)}}this.items=items},_setActiveOffset:function(){this.activeOffset=.9*(this.scrollVertical?this.wrapperHeight:this.wrapperWidth)},_initializePositions:function(){var items=this.items,windowSize=this.scrollVertical?this.wrapperHeight:this.wrapperWidth,positioned=this.surfacesPositioned,itemsSize=items.length,sizeNotCover=true,sizeNeeded=windowSize+2*this.activeOffset,heightSum=0,i=0,item,surface,height;for(;i<itemsSize&&sizeNotCover;i++){item=items[i];surface=this._getAvailableSurface();heightSum+=this._attachItemInSurface(item,surface,{index:i,offset:heightSum});sizeNotCover=heightSum<sizeNeeded;positioned[i]=surface}this._updateSurfaceSizeTracker(0,this.scrollVertical?heightSum:0)},_createSurfaceDOM:function(options,domContent){options||(options={});var rawSurface=w.document.createElement("div"),surfaceStyle=rawSurface.style;rawSurface.className=options["class"]?"surface "+options["class"]:"surface";surfaceStyle.height=options.height&&options.height+"px";surfaceStyle.width=options.width&&options.width+"px";surfaceStyle[STYLES.transform]="scale3d(0.0001, 0.0001, 1)";if(domContent){rawSurface.appendChild(domContent)}return rawSurface},_createSurface:function(options,domContent){options||(options={});var surfaceDOM=this._createSurfaceDOM(options,domContent);return{dom:surfaceDOM,contentIndex:options.index,content:domContent,state:0,offset:0,width:0,height:0}},_createSurfaces:function(size,options){options||(options={});var surfaces=[],i;for(i=0;i<size;i++){surfaces.push(this._createSurface(options))}return surfaces},_getSurfaceTotalOffset:function(surface){return surface.offset+(this.scrollVertical?surface.height:surface.width)},_attachItemInSurface:function(item,surface,config){var offset=config.offset,index=config.index,width,height,offsetX=0,offsetY=0;surface.dom.appendChild(item.dom);height=surface.dom.offsetHeight;width=surface.dom.offsetWidth;if(this.scrollVertical){offsetY=config.preCalculateSize?offset-height:offset}else{offsetX=config.preCalculateSize?offset-width:offset}surface.dom.style[STYLES.transform]=this._transformFnc(offsetX,offsetY);surface.state=1;surface.contentIndex=index;surface.content=item;surface.height=height;surface.width=width;surface.offset=offsetY||offsetX;return this.scrollVertical?height:width},_dettachItemInSurface:function(surface){surface.state=0;surface.contentIndex=null;surface.content=null;surface.height=null;surface.width=null;surface.offset=null;surface.dom.removeChild(surface.dom.firstChild)},_attachSurfaces:function(surfaces,ignorePool){var docfrag=w.document.createDocumentFragment(),target=this.scroller,surface,i;for(i=0;i<surfaces.length;i++){surface=surfaces[i];docfrag.appendChild(surface.dom);if(!ignorePool){this.surfacesPool.push(surface)}}target.appendChild(docfrag)},_getAvailableSurface:function(){var pool=this.surfacesPool,surfaces,surface;for(var i=0;i<pool.length;i++){surface=pool[i];if(!surface.state){return surface}}surfaces=this._createSurfaces(1);this._attachSurfaces(surfaces);return this._getAvailableSurface()},_emptyScroller:function(){return!this.getNumItems()},_initializeSurfaces:function(){var items=this.items,numSurfaces=Math.min(INITIAL_SURFACES,items.length),surfaces=this._createSurfaces(numSurfaces);this._attachSurfaces(surfaces);this._attachTrackSurface()},_attachTrackSurface:function(){var wpSurface=this._createSurface();wpSurface.dom.style.cssText="width:100%;height:1px;opacity:0";wpSurface.dom.classList.add("max-size-tracker");this._sizeTrackSurface=wpSurface;this._attachSurfaces([wpSurface],true);this.lastTrackSizeX=0;this.lastTrackSizeY=0},_resetSurfaces:function(){var surfaces=this.surfacesPositioned,surfacesCount=surfaces.length,surface;for(var i=0;i<surfacesCount;i++){surface=surfaces.shift();this._dettachItemInSurface(surface)}},_updateOffset:function(){var last=this._positionedSurfacesLast(),vertical=this.scrollVertical,offset=last.offset+(vertical?last.height:last.width),x=vertical?0:offset,y=vertical&&offset;this._updateSurfaceSizeTracker(x,y)},_updateSurfaceSizeTracker:function(x,y){if(this._sizeTrackSurface&&(x>this.lastTrackSizeX||y>this.lastTrackSizeY)){this.lastTrackSizeX=x;this.lastTrackSizeY=y;this._sizeTrackSurface.dom.style[STYLES.transform]="translate3d("+x+"px,"+y+"px,0)"}},_mod:function(index){return index},_positionBeingUsed:function(index){var topSurface=this._positionedSurfacesFirst(),bottomSurface=this._positionedSurfacesLast();return index===topSurface.contentIndex||index===bottomSurface.contentIndex},_positionedSurfacesFirst:function(){return this.surfacesPositioned[0]},_positionedSurfacesLast:function(){var p=this.surfacesPositioned;return p[p.length-1]},_positionedSurfacesPush:function(){var bottomSurface=this._positionedSurfacesLast(),bottomSurfaceEnd=this._getSurfaceTotalOffset(bottomSurface),index=this._mod(bottomSurface.contentIndex+1),payload={index:index,offset:bottomSurfaceEnd},surface;if(!this._positionBeingUsed(index)){surface=this._getAvailableSurface();this._attachItemInSurface(this.items[index],surface,payload);this.surfacesPositioned.push(surface);Logger.log("PUSH   ",Date.now());return surface}else{return bottomSurface}},_positionedSurfacesPop:function(){Logger.log("POP    ",Date.now());var surface=this.surfacesPositioned.pop();this._dettachItemInSurface(surface);return this._positionedSurfacesLast()},_positionedSurfacesUnshift:function(){var topSurface=this._positionedSurfacesFirst(),index=this._mod(topSurface.contentIndex-1),payload={index:index,offset:topSurface.offset,preCalculateSize:true},surface;if(!this._positionBeingUsed(index)){surface=this._getAvailableSurface();this._attachItemInSurface(this.items[index],surface,payload);this.surfacesPositioned.unshift(surface);Logger.log("UNSHIFT",Date.now());return surface}else{return topSurface}},_positionedSurfacesShift:function(){Logger.log("SHIFT  ",Date.now());var surface=this.surfacesPositioned.shift();this._dettachItemInSurface(surface);return this._positionedSurfacesFirst()},_itemsLeft:function(end){var firstIndex=this._positionedSurfacesFirst().contentIndex,lastIndex=this._positionedSurfacesLast().contentIndex,count=this.items.length-1,left;left=end==="top"?firstIndex>0:end==="bottom"?lastIndex<count:firstIndex>0||lastIndex<count;return left},_getBoundaries:function(coord,size){var offsetSize=this.activeOffset,abs=Math.abs(coord);return{top:abs-offsetSize>0?abs-offsetSize:0,bottom:abs+size+offsetSize}},_updateAllowed:function(current){return current.pos<0&&(this._isScrolling||Math.abs(current.dist)>10)},_recycleSurface:function(side){return true},_getPosition:function(vertical){if(this.scrollVertical){return{pos:this.y,dist:this.distY,size:this.wrapperHeight,maxScroll:this.maxScrollY}}else{return{pos:this.x,dist:this.distX,size:this.wrapperWidth,maxScroll:this.maxScrollX}}},_updateSurfaceManager:function(){if(this._emptyScroller()||!this.surfacesPositioned.length){if(this.getNumItems()>0){this._initializePositions();this._setInfiniteScrollerSize()}return}var self=this,current=this._getPosition(),nativeScroller=this.opts.useNativeScroller,boundaries=this._getBoundaries(current.pos,current.size),itemsLeft=this._itemsLeft("bottom"),topSurface=this._positionedSurfacesFirst(),topSurfaceEnd=this._getSurfaceTotalOffset(topSurface),bottomSurface=this._positionedSurfacesLast(),bottomSurfaceEnd=bottomSurface.offset,yieldTask=false,inUse=false,surface,index,payload;if(!this._updateAllowed(current)){return}if(!nativeScroller&&this._isScrolling&&!itemsLeft&&current.pos<current.maxScroll-current.size/4){this._isAnimating=false;this._isScrolling=false;this._stopMomentum();RAF(function(){self._resetPosition(self.opts.bounceTime)})}if(current.dist<0){while(this._itemsLeft("bottom")&&bottomSurfaceEnd<boundaries.bottom&&!inUse){surface=this._positionedSurfacesPush();if(surface===bottomSurface){inUse=true}else{bottomSurface=surface;bottomSurfaceEnd=bottomSurface.offset;yieldTask=true;this._updateOffset()}}if(yieldTask){return this._setInfiniteScrollerSize()}while(boundaries.top>topSurfaceEnd&&this._recycleSurface("top")){topSurface=this._positionedSurfacesShift();topSurfaceEnd=this._getSurfaceTotalOffset(topSurface);yieldTask=true}}else{while(topSurface.offset>boundaries.top&&!inUse){surface=this._positionedSurfacesUnshift();if(surface===topSurface){inUse=true}else{topSurface=surface;topSurfaceEnd=this._getSurfaceTotalOffset(topSurface);yieldTask=true}}if(yieldTask){return this._setInfiniteScrollerSize()}while(bottomSurfaceEnd>boundaries.bottom&&this._itemsLeft("top")&&this._recycleSurface("bottom")){bottomSurface=this._positionedSurfacesPop();bottomSurfaceEnd=bottomSurface.offset;yieldTask=true}}if(yieldTask){return this._setInfiniteScrollerSize()}},_setInfiniteScrollerSize:function(){var positioned=this.surfacesPositioned,items=this.items,size=this.scrollVertical?this.wrapperHeight:this.wrapperWidth,ptlEnabled=this.opts.pullToLoadMore&&this._ptlIsEnabled(),lastPos=ptlEnabled?positioned.length-3:positioned.length-1,last=positioned[lastPos],itemsSize=this.getNumItems(),itemsLeft=0,offset=0,ptrSize;if(last){itemsLeft=last.contentIndex<itemsSize-(ptlEnabled?2:1);offset=last.offset+(this.scrollVertical?last.height:last.width)}if(this.scrollVertical){this.maxScrollY=itemsLeft?Number.NEGATIVE_INFINITY:size-offset;this.maxScrollY=this.maxScrollY>0?0:this.maxScrollY}else{this.maxScrollX=itemsLeft?Number.NEGATIVE_INFINITY:size-offset;this.maxScrollX=this.maxScrollX>0?0:this.maxScrollX}this.hasScrollY=this.maxScrollY<0;this.hasScrollX=this.maxScrollX<0;if(ptlEnabled){this._setInfinitePullToShowMoreSpacer(offset)}},_setInfinitePullToShowMoreSpacer:function(bottomOffset){if(this.ptlSpacerSize<=0){return}var diff=this.wrapperHeight-bottomOffset,spaceBottom=diff>0,positioned=this.surfacesPositioned,last=positioned[positioned.length-1],surface=last&&last.dom;this.ptlSpacerSize=spaceBottom?diff:0;this.ptlSpacer.style.height=this.ptlSpacerSize+"px";if(surface){diff=spaceBottom?this.wrapperHeight:bottomOffset;surface.style[STYLES.transform]=this._transformFnc(0,diff)}},_appendPullToLoad:function(){var ptr_container=this._createPullToLoadMarkup();this.items.push({ptl:true,dom:ptr_container});this.ptlDOM=ptr_container;this.ptlIcon=ptr_container.firstChild;this._ptlSnapTime=200;this._ptlEnabled=true;if(this.maxScrollY>=0){this._ptlToggle("disable")}},resize:function(){var self=this;this._stopMomentum();RAF(function(t){self._setWrapperSize();self.refresh();self._scrollTo(0,0)})},refresh:function(){this._resetSurfaces();this._initializePositions();this._setInfiniteScrollerSize()},_prependData:function(data){var item,i;for(i=0;i<data.length;i++){item={dom:data[i]};this.items.unshift(item)}},_appendData:function(data){var customAppended=this._getCustomAppendedElements(),queue=[],ptl,item,i,spacer;for(i=0;i<customAppended;i++){queue.push(this.items.pop());this._positionedSurfacesPop()}for(i=0;i<data.length;i++){item={dom:data[i]};this.items.push(item)}var size=queue.length;for(i=0;i<size;i++){this.items.push(queue.pop())}},getNumItems:function(){return this.items.length-this._getCustomAppendedElements()},prependItems:function(items){var parsedData=HELPERS.parseDOM(items);if(parsedData){this._prependData(parsedData);this.refresh()}},appendItems:function(items){var parsedData=HELPERS.parseDOM(items);if(parsedData){this._appendData(parsedData);this._updateSurfaceManager()}}};SCROLLER.SurfaceManager=PLUGINS.SurfaceManager=SurfaceManager;return SurfaceManager})(window);(function(w){"use strict";w||(w=window);var SCROLLER=w.__S||(w.__S={}),NOW=Date.now||function(){return(new Date).getTime()},RAF=w.requestAnimationFrame,STYLES=SCROLLER.styles,HELPERS=SCROLLER.helpers,PLUGINS=SCROLLER.plugins||(SCROLLER.plugins={}),DEFAULTS_INDICATOR={interactive:false,resize:true,snap:true},DEFAULT_STYLE_SCROLLBAR=["position:absolute","z-index:9999"].join(";"),DEFAULT_STYLE_INDICATOR=["-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box","position:absolute","background:rgba(0,0,0,0.5)","border:1px solid rgba(255,255,255,0.9)","border-radius:3px"].join(";"),DEFAULT_STYLE_VERTICAL_SB=["","height:7px","left:2px","right:2px","bottom:0"].join(";"),DEFAULT_STYLE_HORIZONTAL_SB=["","width:7px","bottom:2px","top:2px","right:1px"].join(";"),FULL_INDICATOR_RATIO=-.1;function Indicator(scroller,options){this.wrapper=typeof options.el==="string"?document.querySelector(options.el):options.el;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=scroller;this.opts=HELPERS.simpleMerge(DEFAULTS_INDICATOR,options);this.scrollVertical=scroller.scrollVertical;this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;this.virtualSizeX=1;this.virtualSizeY=1;if(this.opts.interactive){if(!this.opts.disableTouch){HELPERS.bind(this.indicator,"touchstart",this);HELPERS.bind(window,"touchend",this)}if(!this.opts.disablePointer){HELPERS.bind(this.indicator,"MSPointerDown",this);HELPERS.bind(window,"MSPointerUp",this)}if(!this.opts.disableMouse){HELPERS.bind(this.indicator,"mousedown",this);HELPERS.bind(window,"mouseup",this)}}}Indicator.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e);break}},destroy:function(){if(this.opts.interactive){HELPERS.unbind(this.indicator,"touchstart",this);HELPERS.unbind(this.indicator,"MSPointerDown",this);HELPERS.unbind(this.indicator,"mousedown",this);HELPERS.unbind(window,"touchmove",this);HELPERS.unbind(window,"MSPointerMove",this);HELPERS.unbind(window,"mousemove",this);HELPERS.unbind(window,"touchend",this);HELPERS.unbind(window,"MSPointerUp",this);HELPERS.unbind(window,"mouseup",this)}},_start:function(e){var point=e.touches?e.touches[0]:e;e.preventDefault();e.stopPropagation();this.transitionTime(0);this.initiated=true;this.moved=false;this.lastPointX=point.pageX;this.lastPointY=point.pageY;this.startTime=NOW();if(!this.opts.disableTouch){HELPERS.bind(window,"touchmove",this)}if(!this.opts.disablePointer){HELPERS.bind(window,"MSPointerMove",this)}if(!this.opts.disableMouse){HELPERS.bind(window,"mousemove",this)}},_move:function(e){var point=e.touches?e.touches[0]:e,timestamp=NOW(),deltaX,deltaY,newX,newY;e.preventDefault();e.stopPropagation();this.moved=true;if(this.scroller.opts.gpuOptimization){newX=point.pageX-this.wrapper.getBoundingClientRect().left-this.width/2;newY=point.pageY-this.wrapper.getBoundingClientRect().top-this.height/2}else{deltaX=point.pageX-this.lastPointX;deltaY=point.pageY-this.lastPointY;this.lastPointX=point.pageX;this.lastPointY=point.pageY;newX=this.x+deltaX;newY=this.y+deltaY}this._pos(newX,newY);this.x=newX;this.y=newY},_end:function(e){if(!this.initiated){return}this.initiated=false;e.preventDefault();e.stopPropagation();HELPERS.unbind(window,"touchmove",this);HELPERS.unbind(window,"MSPointerMove",this);HELPERS.unbind(window,"mousemove",this)},_pos:function(x,y){var self=this;if(x<0){x=0}else if(x>this.maxPosX){x=this.maxPosX}if(y<0){y=0}else if(y>this.maxPosY){y=this.maxPosY}x=!this.scrollVertical?Math.round(x/this.sizeRatioX):this.scroller.x;y=this.scrollVertical?Math.round(y/this.sizeRatioY):this.scroller.y;if(!this._rafPos){this._rafPos=RAF(function(t){self._posRAF(x,y)})}},_posRAF:function(x,y){this.scroller.scrollTo(x,y);this._rafPos=false},transitionTime:function(time){time=time||0;this.indicatorStyle[STYLES.transitionDuration]=time+"ms"},transitionEasing:function(easing){this.indicatorStyle[STYLES.transitionTimingFunction]=easing},getCurrentSizes:function(){if(this.scrollVertical){return{virtual:this.virtualSizeY,wrapperSize:this.wrapperHeight,maxScroll:this.scroller.maxScrollY}}else{return{virtual:this.virtualSizeX,wrapperSize:this.wrapperWidth,maxScroll:this.scroller.maxScrollX}}},getVirtualScrollSize:function(){var s=this.getCurrentSizes();if(s.virtual<s.wrapperSize){return Math.abs(s.maxScroll)||s.wrapperSize}else{return s.virtual}},getVirtualMaxSize:function(scrollSize){var s=this.getCurrentSizes();return s.maxScroll===-Infinity?-scrollSize:s.virtual?s.wrapperSize-scrollSize:s.maxScroll},refresh:function(){this.transitionTime(0);var scroller=this.scroller,wHeight=this.wrapperHeight=this.wrapper.offsetHeight,wWidth=this.wrapperWidth=this.wrapper.offsetWidth,size=this.scrollVertical?wHeight:wWidth,scrollSize=Math.max(this.getVirtualScrollSize(),size),maxScroll=this.getVirtualMaxSize(scrollSize),indicatorSize=Math.max(Math.round(size*size/scrollSize),8);if(this.scrollVertical){if(this.opts.resize){this.indicatorHeight=indicatorSize;this.indicatorStyle.height=this.indicatorHeight+"px"}else{this.indicatorHeight=this.indicator.offsetHeight}this.maxPosY=size-this.indicatorHeight;this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY;this.sizeRatioY=this.maxPosY/maxScroll||FULL_INDICATOR_RATIO;this.height=this.indicatorHeight}else{if(this.opts.resize){this.indicatorWidth=indicatorSize;this.indicatorStyle.width=this.indicatorWidth+"px"}else{this.indicatorWidth=this.indicator.offsetWidth}this.maxPosX=size-this.indicatorWidth;this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX;this.sizeRatioX=this.maxPosX/maxScroll||FULL_INDICATOR_RATIO;this.width=this.indicatorWidth}this.updatePosition()},_updatePositionAbstractProperties:function(x,y){if(this.scrollVertical){return{posRatio:y,indicatorSize:this.indicatorHeight,size:this.height,minBoundary:this.minBoundaryY,maxBoundary:this.maxBoundaryY,maxPos:this.maxPosY}}else{return{posRatio:x,indicatorSize:this.indicatorWidth,size:this.width,minBoundary:this.minBoundaryX,maxBoundary:this.maxBoundaryX,maxPos:this.maxPosX}}},updatePosition:function(){var x=this.sizeRatioX*this.scroller.x,y=this.sizeRatioY*this.scroller.y,s=this._updatePositionAbstractProperties(x,y),pos=s.posRatio,scaleX=1,scaleY=1,scale,tmpSize;if(pos<s.minBoundary){tmpSize=this.opts.snap?Math.max(s.indicatorSize+s.posRatio*3,8):s.indicatorSize;scale=tmpSize/s.size;pos=s.minBoundary-(s.size-tmpSize)/2}else if(pos>s.maxBoundary){tmpSize=this.opts.snap?Math.max(s.indicatorSize-(s.posRatio-s.maxPos)*3,8):s.indicatorSize;scale=tmpSize/s.size;pos=s.maxPos+(s.size-tmpSize)/2}if(scale){if(this.scrollVertical){scaleY=scale;y=pos}else{scaleX=scale;x=pos}}this.x=x;this.y=y;this.indicatorStyle[STYLES.transform]="matrix3d("+scaleX+",0,0,0,0,"+scaleY+",0,0,0,0,1,0,"+x+","+y+", 0, 1)"}};function Indicators(){}Indicators.prototype={init:function(){this._indicators=[];this._virtualScroll=0;this.on("_initialize",this._initializeIndicators);this.on("_update",this._updateIndicators);this.on("_refresh",this._refreshIndicators);this._hook("after","_transitionTime",this._transitionTimeIndicators);this._hook("after","_transitionEasing",this._transitionEasingIndicators);this._hook("after","_translate",this._updateIndicators);this._hook("after","_setInfiniteScrollerSize",this._setVirtualScrollSize)},_initializeIndicators:function(){var self=this;if(this.opts.scrollbars){this._createDefaultScrollbars(this.opts.scrollbars)}if(this.opts.indicators){this.opts.indicators.forEach(function(i){self.addIndicator(i.el,i.config)})}this._initVirtualScrollSize()},_initVirtualScrollSize:function(){var hasScroll=this.scrollVertical?this.hasScrollY:this.hasScrollX,virtualSize=this.scrollVertical?"virtualSizeY":"virtualSizeX",virtualScroll=hasScroll?this._virtualScroll:0;this._indicators.forEach(function(i){i[virtualSize]=virtualScroll;i.refresh()})},_setVirtualScrollSize:function(){var last=this._positionedSurfacesLast(),virtualScroll=last.offset+(this.scrollVertical?last.height:last.width),virtualSize=this.scrollVertical?"virtualSizeY":"virtualSizeX";if(virtualScroll>this._virtualScroll){this._virtualScroll=virtualScroll;this._indicators.forEach(function(i){i[virtualSize]=virtualScroll;i.refresh()})}},_updateIndicators:function(){this._indicators.forEach(function(i){i.updatePosition()})},_refreshIndicators:function(){this._indicators.forEach(function(i){i.refresh()})},_transitionTimeIndicators:function(time){time||(time=0);this._indicators.forEach(function(i){i.transitionTime(time)})},_transitionEasingIndicators:function(easing){this._indicators.forEach(function(i){i.transitionEasing(easing)})},_createDefaultScrollbars:function(config){var interactive=true,customStyle=false,scrollbar=this._createDefaultScrollbar(this.scrollVertical,interactive,customStyle);this.wrapper.appendChild(scrollbar);this._indicators.push(new Indicator(this,{el:scrollbar,interactive:interactive}))},_createDefaultScrollbar:function(vertical,interactive,customStyle){var scrollbar=w.document.createElement("div"),indicator=w.document.createElement("div"),inlineStyleScrollbar=DEFAULT_STYLE_SCROLLBAR,inlineStyleIndicator=DEFAULT_STYLE_INDICATOR;indicator.className="scrollbar";indicator.style.cssText=inlineStyleIndicator;if(!vertical){if(!customStyle){scrollbar.style.cssText+=inlineStyleScrollbar+DEFAULT_STYLE_VERTICAL_SB;indicator.style.height="100%"}scrollbar.className="scrollbar-horizontal"}else{if(!customStyle){scrollbar.style.cssText+=inlineStyleScrollbar+DEFAULT_STYLE_HORIZONTAL_SB;indicator.style.width="100%"}scrollbar.className="scrollbar-vertical";
}if(!interactive){scrollbar.style.pointerEvents="none"}scrollbar.appendChild(indicator);return scrollbar},addIndicator:function(el,cfg){cfg||(cfg={});cfg.el=el;var indicator=new Indicator(this,cfg);this._indicators.push(indicator);indicator.refresh()}};Indicators.Indicator=Indicator;PLUGINS.Indicators=Indicators})(window);(function(w){"use strict";w||(w=window);var SCROLLER=w.__S||(w.__S={}),PLUGINS=SCROLLER.plugins||(SCROLLER.plugins={}),STYLES=SCROLLER.styles;function ZoomFX(){}ZoomFX.prototype={init:function(){this.on("_initialize",this._updateZoomFX);this.on("_update",this._updateZoomFX)},_updateZoomFX:function(){var self=this,surfaces=this.surfacesPositioned,current=this._getPosition(),boundaries=this._getBoundaries(current.pos,current.size);surfaces.forEach(function(s){self._applyFunctionToSurface(s,current,boundaries)})},_getNormalizedPosition:function(pos,start,size){var percentage=Math.abs(1-(pos-start)/size*.7),caped=Math.max(.1,percentage);return(1-caped)*1.1},_applyFunctionToSurface:function(surface,current,boundaries){var offset=surface.offset,size=current.size,pos=-current.pos,top=pos-size,bottom=pos+size,percent=this._getNormalizedPosition(offset,top,size),y=this.scrollVertical?offset:0,x=!this.scrollVertical?offset:0,matrix;matrix=this._calculateMatrixEffect(x,y,percent);surface.dom.style[STYLES.transform]=matrix.toString()},_calculateMatrixEffect:function(x,y,normalizedPos){var matrix=new STYLES.matrix;matrix.m42=y;matrix.m41=x;matrix.m33=1;matrix=matrix.scale(normalizedPos);return matrix}};PLUGINS.ZoomFX=ZoomFX})(window);(function(w){"use strict";w||(w=window);var NOW=Date.now||function(){return(new Date).getTime()},RAF=w.requestAnimationFrame,CAF=w.cancelAnimationFrame,SCROLLER=w.__S||{},PLUGINS=SCROLLER.plugins,HELPERS=SCROLLER.helpers,SUPPORT=SCROLLER.support,STYLES=SCROLLER.styles,CubicBezier=SCROLLER.CubicBezier,Logger=SCROLLER.Logger,IS_IOS=SUPPORT.isIOS,ACTION_RESET="reset",ACTION_LOCK="lock",ACTION_GESTURE_START="gestureStart",ACTION_GESTURE_MOVE="gestureMove",ACTION_SCROLL_MOVE="scrollMove",ACTION_GESTURE_END="gestureEnd",ACTION_ANIM_START="animationStart",ACTION_ANIM_MOVING="animationMove",ACTION_ANIM_END="animationEnd",ACTION_SCROLL="scroll",ACION_DOM_MUTATION="mutationObserver",HOOK_BEFORE="before",HOOK_AFTER="after",EVENT_TYPE={touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:4,MSPointerMove:4,MSPointerUp:4},SCROLL_VERTICAL="vertical",SCROLL_HORIZONTAL="horizontal",SCROLL_BIDIRECTIONAL="bidirectional",MUTATOR_OBSERVER_CONFIG={subtree:true,childList:true,attributes:false},DEFAULTS={enabled:true,bounceTime:600,useCSSTransition:false,useNativeScroller:false,dualListeners:false,minThreshold:5,minDirectionThreshold:2,lockOnDirection:null,itemHeight:null,itemWidth:null,bindToWrapper:false,scroll:SCROLL_VERTICAL,pullToRefresh:false,pullToLoadMore:false,scrollbars:false,infiniteLoading:false,gpuOptimization:false,debounce:true,observeDomChanges:true,observeDomConfig:MUTATOR_OBSERVER_CONFIG},EASING_REGULAR=CubicBezier(.33,.66,.66,1),EASING_BOUNCE=CubicBezier(.33,.33,.66,.81),EASING={regular:{style:EASING_REGULAR.toString(),fn:EASING_REGULAR},bounce:{style:EASING_BOUNCE.toString(),fn:EASING_BOUNCE}},MIN_VELOCITY=.1,ACCELERATION_CONSTANT=5e-4,MOUSE_WHEEL_SPEED=20,MOUSE_WHEEL_INVERTED=false;function Scroller(el,config){config||(config={});this._initializeScroller();this._setConfig(config);this._setElement(el);this._setSize();this._initializePlugins(config);this._initialize();this._handleEvents("bind")}Scroller.DEFAULTS=DEFAULTS;Scroller.CubicBezier=CubicBezier;Scroller.EASING_REGULAR=EASING_REGULAR;Scroller.EASING_BOUNCE=EASING_BOUNCE;Scroller.EASING=EASING;Scroller.MIN_VELOCITY=MIN_VELOCITY;Scroller.ACCELERATION_CONSTANT=ACCELERATION_CONSTANT;Scroller.SCROLL_VERTICAL=SCROLL_VERTICAL;Scroller.SCROLL_HORIZONTAL=SCROLL_HORIZONTAL;Scroller.MOUSE_WHEEL_SPEED=MOUSE_WHEEL_SPEED;Scroller.MOUSE_WHEEL_INVERTED=MOUSE_WHEEL_INVERTED;Scroller.Logger=Logger;Scroller.plugins=PLUGINS;Scroller.registerPlugin=function(name,plugin){if(this.plugins[name]){Logger.log("Overriding plugin: ",name)}this.plugins[name]=plugin};Scroller.prototype={_initializeScroller:function(){this._events={};this.x=0;this.y=0},_initialize:function(){this._fire("_initialize")},_initializePlugins:function(cfg){var userPlugins=this.opts.plugins,SurfaceManager=PLUGINS.SurfaceManager,PullToRefresh=PLUGINS.PullToRefresh,PullToLoadMore=PLUGINS.PullToLoadMore,enableSM=!this.opts.useCSSTransition&&this.opts.gpuOptimization,enablePTR=this.opts.onPullToRefresh,enablePTL=this.opts.onPullToLoadMore;if(enablePTR&&PullToRefresh){this.plug(PullToRefresh)}if(enablePTL&&PullToLoadMore){this.plug(PullToLoadMore)}if(enableSM&&SurfaceManager){this.plug(SurfaceManager)}if(userPlugins){userPlugins.forEach(function(plugin){this.plug(plugin)},this)}},_observeChanges:function(){return window.MutationObserver&&this.opts.observeDomChanges&&!this.opts.gpuOptimization},_initializeDOMObserver:function(){var self=this,config=this.opts.observeDomConfig,observer=this.observer=new MutationObserver(function(){self._observedDOMChange.apply(self,arguments)});observer.observe(this.wrapper,config)},_observedDOMChange:function(e){this.refresh(ACION_DOM_MUTATION)},_mergeConfigOptions:function(cfg,toMerge){return HELPERS.simpleMerge(cfg,toMerge)},setEnable:function(enabled){this.enabled=enabled},_setConfig:function(cfg){var opts=this.opts=this._mergeConfigOptions(DEFAULTS,cfg);this.enabled=opts.enabled;this.scroll=opts.scroll;this.itemHeight=opts.itemHeight;this.itemWidth=opts.itemWidth;this.acceleration=opts.acceleration||ACCELERATION_CONSTANT;this.scrollVertical=this.scroll===SCROLL_VERTICAL;this.scrollHorizontal=this.scroll===SCROLL_HORIZONTAL;if(opts.infiniteLoading&&opts.pullToLoadMore){Logger.log("You cannot have infiniteLoading and pullToShowMore at the same time."+"Switching to infiniteLoading");this.opts.pullToLoadMore=false}if(this.scrollHorizontal&&(opts.pullToRefresh||opts.pullToLoadMore)){Logger.log("The attributes: pullToRefresh or pullToShowMore are not available in horizontal mode yet."+" Switching them to false");this.opts.pullToRefresh=false;this.opts.pullToLoadMore=false}if(this.opts.scroll===SCROLL_BIDIRECTIONAL){this.opts.debounce=false}},_setElement:function(el){this.wrapper=typeof el==="string"?w.document.querySelector(el):el;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;var scrollDirection=this.scroll===SCROLL_BIDIRECTIONAL?"scroll-bidirectional":this.scrollVertical?"scroll-vertical":"scroll-horizontal";this.scroller.classList.add("scroller");this.wrapper.classList.add("scroller-wrapper");this.wrapper.classList.add(scrollDirection);if(this.opts.useNativeScroller){this.wrapper.classList.add("native")}},_setWrapperSize:function(){var oldSize=this.wrapperSize;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.wrapperSize=this.scrollVertical?this.wrapperHeight:this.wrapperWidth;if(this.opts.useNativeScroller&&oldSize!==this.wrapperSize){this.scroller.style.height=this.wrapperSize+"px"}},_setSize:function(contentOnly){var scrollerDOM=this.scroller,ptl=this.opts.pullToLoadMore;if(!contentOnly){this._setWrapperSize();this._sizePullToShowMore()}this.scrollerWidth=scrollerDOM.offsetWidth;this.scrollerHeight=ptl?scrollerDOM.offsetHeight-this.getPTLSize():scrollerDOM.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.maxScrollX=this.maxScrollX>0?0:this.maxScrollX;this.maxScrollY=this.maxScrollY>0?0:this.maxScrollY;this.hasScrollX=this.maxScrollX<0;this.hasScrollY=this.maxScrollY<0},_sizePullToShowMore:function(){},getPTLSize:function(){return 0},_getCustomAppendedElements:function(){return 0},_destroy:function(){this._handleEvents("unbind")},_iosScrollFixture:function(e){if(this.scroller.scrollTop===0){this.scroller.scrollTop=1}},_handleEvents:function(action){var self=this,eventType=action==="bind"?HELPERS.bind:HELPERS.unbind,wrapper=this.wrapper,target=this.opts.bindToWrapper?wrapper:window,pHandlers=false,scroller=this.scroller;eventType(window,"orientationchange",this);eventType(window,"resize",this);if(this._observeChanges()){this._initializeDOMObserver()}if(this.opts.useNativeScroller){eventType(this.scroller,"scroll",this);if(IS_IOS&&!this.opts.pullToRefresh){eventType(wrapper,"touchstart",function(e){self._iosScrollFixture.apply(self,arguments)})}return}if(SUPPORT.touch&&!this.opts.disableTouch){eventType(wrapper,"touchstart",this);eventType(target,"touchmove",this);eventType(target,"touchcancel",this);eventType(target,"touchend",this)}if((SUPPORT.pointers||SUPPORT.msPointers)&&!this.opts.disablePointers){if(SUPPORT.pointers){eventType(wrapper,"pointerdown",this);eventType(target,"pointermove",this);eventType(target,"pointercancel",this);eventType(target,"pointerup",this)}else{eventType(wrapper,"MSPointerDown",this);eventType(target,"MSPointerMove",this);eventType(target,"MSPointerCancel",this);eventType(target,"MSPointerUp",this)}pHandlers=true}if(!this.opts.disableMouse&&(!pHandlers||pHandlers&&this.opts.dualListeners)){eventType(wrapper,"mousedown",this);eventType(target,"mousemove",this);eventType(target,"mousecancel",this);eventType(target,"mouseup",this)}if(!this.opts.disableWheel&&!this.opts.useNativeScroller){eventType(wrapper,"wheel",this);eventType(wrapper,"mousewheel",this);eventType(wrapper,"DOMMouseScroll",this)}eventType(this.scroller,"transitionend",this);eventType(this.scroller,SUPPORT.prefix+"TransitionEnd",this)},_fire:function(eventType){var eventQueue=this._events[eventType],eventFncs=eventQueue&&eventQueue.length,params=Array.prototype.slice.call(arguments,1),ePayload;if(eventFncs){for(var i=0;i<eventFncs;i++){ePayload=eventQueue[i];ePayload.fn.apply(ePayload.context||this,params)}}},_hook:function(when,method,hookFn){var self=this,toHookMethod=this[method];if(toHookMethod){if(when===HOOK_AFTER){this[method]=function(){toHookMethod.apply(this,arguments);hookFn.apply(this,arguments)}}else if(when===HOOK_BEFORE){this[method]=function(){hookFn.apply(this,arguments);toHookMethod.apply(this,arguments)}}}},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this.resize();break;case"transitionend":case SUPPORT.prefix+"TransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"scroll":this._nativeScroll(e)}},_start:function(e){if(!this.enabled||this._initiated&&EVENT_TYPE[e.type]!==this._initiated){return}var point=e.touches?e.touches[0]:e;this._initiated=EVENT_TYPE[e.type];this.moved=false;this.distX=0;this.distY=0;this.velocity=0;this.scrollDirection=null;this._transitionTime();this._isAnimating=false;if(this._isScrolling){this._stopMomentum();this._isScrolling=false;this._onStopScrolling(e)}this.startX=this.x;this.startY=this.y;this.pointX=point.pageX;this.pointY=point.pageY;this.startTime=NOW();this._lastPosition=this.scrollVertical?this.startY:this.startX;this._fire("beforeScrollStart",ACTION_GESTURE_START,e)},_onStopScrolling:function(e){e.preventDefault()},_trackVelocity:function(t){var lastPos=this._lastPosition,currentPos=this.scrollVertical?this.y:this.x,elapsed=17,delta=currentPos-lastPos,v;this._lastPosition=currentPos;v=delta/elapsed;this.velocity=.6*v+.4*this.velocity},_startMoveRAF:function(){var self=this;function moveStep(t){self._translate(self.x,self.y);self._trackVelocity(t);self._update();self._fire(ACTION_SCROLL_MOVE,ACTION_GESTURE_MOVE,self.x,self.y);self._rafMoving=RAF(moveStep)}moveStep()},_endMoveRAF:function(){CAF(this._rafMoving)},_update:function(){this._fire("_update")},_needsLocking:function(){return this.opts.lockOnDirection&&this.scrollDirection&&this.opts.lockOnDirection===this.scrollDirection},_lockScroller:function(){this._initiated=false;this._fire(ACTION_LOCK,this.scrollDirection)},_getScrollDirection:function(absX,absY){var treshold=this.opts.minDirectionThreshold;this.scrollDirection=absX>absY+treshold?SCROLL_HORIZONTAL:absY>absX+treshold?SCROLL_VERTICAL:null;if(this.scrollDirection&&this.opts.lockOnDirection&&this.scroll===SCROLL_BIDIRECTIONAL){this.scrollVertical=this.scrollDirection===SCROLL_VERTICAL}return this.scrollDirection},_isOutOfScroll:function(x,y){return this.scrollVertical?y>0||y<this.maxScrollY:x>0||x<this.maxScrollX},_setNormalizedXY:function(x,y){if(!this.opts.lockOnDirection&&this.scroll===SCROLL_BIDIRECTIONAL){this.x=x;this.y=y}else if(this.scrollVertical){this.y=y}else{this.x=x}},_move:function(e){if(!this.enabled||EVENT_TYPE[e.type]!==this._initiated||e.cancelScrolling){e.scrollDirection=this.scrollDirection;return}var point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY,timestamp=NOW(),newX,newY,absDistX,absDistY;if(!this.moved&&(deltaX||deltaY)){this.moved=true;this._translate(this.x,this.y);this._fire("scrollStart",ACTION_GESTURE_START,e);if(!this.opts.useCSSTransition||this.opts.debounce){this._startMoveRAF()}}this.pointX=point.pageX;this.pointY=point.pageY;this.distX=this.distX+deltaX;this.distY=this.distY+deltaY;absDistX=Math.abs(this.distX);absDistY=Math.abs(this.distY);newX=this.x+deltaX;newY=this.y+deltaY;e.scrollDirection=this.scrollDirection||this._getScrollDirection(absDistX,absDistY);if(this._needsLocking()){this._lockScroller();return}if(this.opts.minThreshold&&(absDistX<this.opts.minThreshold&&absDistY<this.opts.minThreshold)){this._fire(ACTION_SCROLL_MOVE,ACTION_GESTURE_MOVE,this.x,this.y,e);return}if(this._isOutOfScroll(newX,newY)){newY=this.y+deltaY/3;newX=this.x+deltaX/3}this._setNormalizedXY(newX,newY);if(this.opts.useCSSTransition&&!this.opts.debounce){this._translate(this.x,this.y);this._fire(ACTION_SCROLL_MOVE,ACTION_GESTURE_MOVE,this.x,this.y,e);if(timestamp-this.startTime>300){this.startTime=timestamp;this.startX=this.x;this.startY=this.y}}},_end:function(e){this._endMoveRAF();if(!this.enabled||!this.moved||EVENT_TYPE[e.type]!==this._initiated){this._initiated=false;return}this._initiated=false;var duration=NOW()-this.startTime,time=0,bounce=EASING.regular,momentum;if(this._resetPosition(this.opts.bounceTime)){return}this._isScrolling=true;if(this.scrollVertical){momentum=this._momentum(this.y,this.startY,duration,this.maxScrollY,this.wrapperHeight);this._scrollTo(this.x,momentum.destination,momentum.time,momentum.bounce)}else if(this.scrollHorizontal){momentum=this._momentum(this.x,this.startX,duration,this.maxScrollX,this.wrapperWidth);this._scrollTo(momentum.destination,this.y,momentum.time,momentum.bounce)}else{var momentumX=this._momentum(this.x,this.startX,duration,this.maxScrollX,this.wrapperWidth),momentumY=this._momentum(this.y,this.startY,duration,this.maxScrollY,this.wrapperHeight);this._scrollTo(momentumX.destination,momentumY.destination,Math.max(momentumX.time,momentumY.time),momentumX.bounce)}},_wheel:function(e){if(!this.enabled){return}e.preventDefault();e.stopPropagation();var self=this,mouseWheelSpeed=Scroller.MOUSE_WHEEL_SPEED,invertWheelDirection=Scroller.MOUSE_WHEEL_INVERTED?-1:1,wheelDeltaX,wheelDeltaY,newX,newY;if("deltaX"in e){wheelDeltaX=-e.deltaX;wheelDeltaY=-e.deltaY}else if("wheelDeltaX"in e){wheelDeltaX=e.wheelDeltaX/120*mouseWheelSpeed;wheelDeltaY=e.wheelDeltaY/120*mouseWheelSpeed}else if("wheelDelta"in e){wheelDeltaX=wheelDeltaY=e.wheelDelta/120*mouseWheelSpeed}else if("detail"in e){wheelDeltaX=wheelDeltaY=-e.detail/3*mouseWheelSpeed}else{return}wheelDeltaX*=invertWheelDirection;wheelDeltaY*=invertWheelDirection;if(this.scrollHorizontal){wheelDeltaX=wheelDeltaY;wheelDeltaY=0}newX=this.x+Math.round(this.hasScrollX?wheelDeltaX:0);newY=this.y+Math.round(this.hasScrollY?wheelDeltaY:0);if(newX>0){newX=0}else if(newX<this.maxScrollX){newX=this.maxScrollX}if(newY>0){newY=0}else if(newY<this.maxScrollY){newY=this.maxScrollY}this.x=newX;this.y=newY;if(!this._rafWheel){this._rafWheel=RAF(function(t){self._isScrolling=true;self._getScrollDirection(wheelDeltaX,wheelDeltaY);self.distY=wheelDeltaY;self.distX=wheelDeltaX;self._wheelRAF()})}},_wheelRAF:function(){this._translate(this.x,this.y);this._update();this._rafWheel=false;this._isScrolling=false;this._fire(ACTION_SCROLL_MOVE,ACTION_ANIM_MOVING,this.x,this.y)},_getVelocity:function(current,start,time){var v=this.opts.debounce?this.velocity:(current-start)/time;if(Math.abs(v)<MIN_VELOCITY){v=0}this.velocity=v;return v},_computeMomentum:function(velocity,current){var acceleration=this.acceleration,time=Math.abs(velocity)/acceleration,distance=velocity/2*time;return{destination:current+distance,time:time}},_computeSnap:function(start,end,velocity,current){var destination=start+end/2*(velocity/8);return{destination:destination,time:Math.abs((destination-current)/velocity)}},_momentum:function(current,start,duration,lowerMargin,wrapperSize){var velocity=this._getVelocity(current,start,duration),momentum=this._computeMomentum(velocity,current);if(momentum.destination<lowerMargin){momentum=this._computeSnap(lowerMargin,wrapperSize,velocity,current);momentum.bounce=EASING.bounce}else if(momentum.destination>0){momentum=this._computeSnap(0,wrapperSize,velocity,current);momentum.bounce=EASING.bounce}return momentum},_stopMomentum:function(){var transform=STYLES.transform,transition=STYLES.transition,style,matrix,x,y;if(this.opts.useCSSTransition){style=w.getComputedStyle(this.scroller,null);if(SUPPORT.matrix){matrix=new STYLES.matrix(style[transform]);this.scrollerStyle[transition]="";x=matrix.m41;y=matrix.m42}else{matrix=style[transform].split(")")[0].split(", ");x=+(matrix[12]||matrix[4]);y=+(matrix[13]||matrix[5])}this._translate(x,y)}else{CAF(this._rafReq)}},_customResetPosition:function(){return this.opts.pullToRefresh||this.opts.pullToLoadMore},_resetPosition:function(time,forceReset){time||(time=0);var x=this.x,y=this.y,custom;if(this._customResetPosition()){if(this.opts.pullToRefresh&&this.isTriggeredPTR()){custom=this.getResetPositionPTR()}else if(this.opts.pullToLoadMore&&this.isTriggeredPTL()){custom=this.resetPositionPTL()}}if(custom){y=custom.y;x=custom.x;time=custom.time||time}else{if(!this.hasScrollY||this.y>0){y=0}else if(this.y<this.maxScrollY){y=this.maxScrollY}if(!this.hasScrollX||this.x>0){x=0}else if(this.x<this.maxScrollX){x=this.maxScrollX}}if(y===this.y&&x===this.x){return false}this._scrollTo(x,y,time,EASING.regular);return true},_transitionEasing:function(easing){this.scrollerStyle[STYLES.transitionTimingFunction]=easing},_transitionTime:function(time){time||(time=0);this.scrollerStyle[STYLES.transitionDuration]=time+"ms"},_translate:function(x,y){if(!this.opts.useNativeScroller||this.forceTranslate){this.scrollerStyle[STYLES.transform]="translate3d("+x+"px,"+y+"px, 0)"}else{this._wrapperScrollTo(x,y)}this.x=x;this.y=y},_transitionEnd:function(e){if(this.opts.useCSSTransition&&e.target===this.scroller){this._transitionTime();if(!this._resetPosition(this.opts.bounceTime)){this._isScrolling=false;this._fire("scrollEnd",ACTION_ANIM_END)}}},_animate:function(x,y,duration,easingFn){var self=this,startX=this.x,startY=this.y,startTime=NOW(),deltaX=x-startX,deltaY=y-startY,destTime=startTime+duration;function step(){var now=NOW(),newX,newY,easing;if(now>=destTime){self._isAnimating=false;self._rafReq=null;self._translate(x,y);if(!self._resetPosition(self.opts.bounceTime)){self._fire("scrollEnd",ACTION_ANIM_END);self._isScrolling=false}return}now=(now-startTime)/duration;easing=easingFn(now);newX=deltaX*easing+startX;newY=deltaY*easing+startY;self._translate(newX,newY);self._fire(ACTION_SCROLL_MOVE,ACTION_ANIM_MOVING,newX,newY);self._update();if(self._isAnimating){self._rafReq=RAF(step)}}this._isAnimating=true;step()},_prependData:function(items){var docfrag=w.document.createDocumentFragment(),scrollerContainer=this.scroller,ptrContainer=scrollerContainer.firstChild;items.forEach(function(i){docfrag.appendChild(i)});if(scrollerContainer.lastChild===ptrContainer){scrollerContainer.appendChild(docfrag)}else{scrollerContainer.insertBefore(docfrag,ptrContainer.nextSibling)}},_appendData:function(items){var docfrag=w.document.createDocumentFragment(),scrollerContainer=this.scroller,i;for(i=0;i<items.length;i++){docfrag.appendChild(items[i])}scrollerContainer.appendChild(docfrag)},_scrollTo:function(x,y,time,easing){easing||(easing=EASING.regular);if(!time||this.opts.useCSSTransition){this._transitionEasing(easing.style);this._transitionTime(time);this._translate(x,y);this._update();if(!time){this._isScrolling=false;this._fire(ACTION_GESTURE_END)}else{this._fire(ACTION_ANIM_START,ACTION_ANIM_START)}}else{this._animate(x,y,time,easing.fn)}},_nativeScroll:function(e){if(SUPPORT.isIOS){this._nativeScrollIOS(e)}else{this._nativeScrollRAF(e)}},_nativeScrollIOS:function(e){if(!this._rafNativeScroll){this._rafNativeScroll=RAF(this._nativeScrollRAF.bind(this,e))}},_nativeScrollRAF:function(e){var x=-this.scroller.scrollLeft,y=-this.scroller.scrollTop;this._fire(ACTION_SCROLL_MOVE,ACTION_SCROLL,x,y,e);this.distX=x-this.x;this.distY=y-this.y;this._isScrolling=true;this._update();this.x=x;this.y=y;this._isScrolling=false;this._rafNativeScroll=false},_wrapperScrollTo:function(x,y){this.wrapper.scrollTop=this.scrollVertical?Math.abs(y):this.wrapper.scrollTop;this.wrapper.scrollLeft=this.scrollVertical?this.wrapper.scrollLeft:Math.abs(x)},on:function(eventType,fn,context){var eventQueue=this._events[eventType]||(this._events[eventType]=[]);eventQueue.push({fn:fn,context:context})},resize:function(){var self=this;RAF(function(){self._translate(0,0);self._setSize()})},refresh:function(){var self=this;if(!this._rafRefresh){this._rafRefresh=RAF(function(){self._fire("_refresh");self._setSize();self._rafRefresh=null})}},plug:function(plugin){var ScrollerPlugin=typeof plugin==="string"?PLUGINS[plugin]:plugin,PluginPrototype=ScrollerPlugin&&ScrollerPlugin.prototype||ScrollerPlugin,whiteList=["init"],methodName;if(PluginPrototype){for(methodName in PluginPrototype){if(whiteList.indexOf(methodName)===-1){this[methodName]=PluginPrototype[methodName]}}if(PluginPrototype.init){PluginPrototype.init.call(this)}}else{console.log("Error adding plugin:",plugin)}},scrollTo:function(x,y,time){if(this.x!==x||this.y!==y){this._stopMomentum();this.distX=x-this.x;this.distY=y-this.y;this._isScrolling=true;this._scrollTo.apply(this,arguments)}},scrollToTop:function(time,easing){this.scrollTo(0,0,time,easing)},scrollToBottom:function(time,easing){var x=this.maxScrollX,y=this.maxScrollY;if(this.scrollVertical){x=0}else{y=0}this.scrollTo(x,y,time,easing)},prependItems:function(data){var parsedData=HELPERS.parseDOM(data);if(parsedData){this._prependData(parsedData);this._setSize()}},appendItems:function(data){var parsedData=HELPERS.parseDOM(data);if(parsedData){this._appendData(parsedData);this._setSize()}},destroy:function(){this._destroy();this._fire("destroy")}};w.Scroller=SCROLLER.constructor=Scroller})(window);