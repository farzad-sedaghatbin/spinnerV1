!function(){var t=function(){var t=this,e={};t.on=function(t,o,n){if(!(arguments.length<2||"string"!=typeof t||"function"!=typeof o)){var a=o.toString();"undefined"!=typeof e[t]?"undefined"==typeof e[t].callbacks[a]?e[t].callbacks[a]={cb:o,once:!!n}:"boolean"==typeof n&&(e[t].callbacks[a].once=n):(e[t]={callbacks:{}},e[t].callbacks[a]={cb:o,once:!!n})}},t.once=function(e,o){t.on(e,o,!0)},t.off=function(t,o){if("string"==typeof t&&"undefined"!=typeof e[t])if("function"==typeof o){var n=o.toString(),a=e[t].callbacks[n];"undefined"!=typeof a&&delete e[t].callbacks[n]}else delete e[t]},t.trigger=function(o,n){if("string"==typeof o&&"undefined"!=typeof e[o])for(var a in e[o].callbacks){var i=e[o].callbacks[a];"function"==typeof i.cb&&i.cb(n),"boolean"==typeof i.once&&i.once===!0&&t.off(o,i.cb)}}};"undefined"!=typeof define&&define.amd?define(function(){"use strict";return new t}):"undefined"!=typeof module&&module.exports?module.exports=new t:window.Bullet=new t}(),function(t){"use strict";function a(t){t.updateScore=function(t){window.location.href="gamee://score/"+t},t.requestController=function(t){window.location.href="gamee://request-controller/"+t},t.gameOver=function(){window.location.href="gamee://game-over"},t.gameStart=function(){e(function(){window.location.href="gamee://game-start"},100)},t.gameLoaded=function(){window.location.href="gamee://game-loaded"},t.type="gamee-mobile"}function i(t){var e=window.parent.gameeSimulator;t.updateScore=function(t){e.updateScore(t)},t.requestController=function(t){e.requestController(t)},t.gameOver=function(){e.gameOver()},t.gameStart=function(){e.gameStart()},t.gameLoaded=function(){e.gameLoaded()},t.type="gamee-simulator"}function r(t){var e=window.parent;t.updateScore=function(t){e.postMessage(["score",t],"*")},t.requestController=function(t){e.postMessage(["request-controller",t],"*")},t.additionalController=function(t){e.postMessage(["additional-controller",t],"*")},t.gameOver=function(){e.postMessage(["game-over"],"*")},t.gameStart=function(){e.postMessage(["game-start"],"*")},t.gamePaused=function(){e.postMessage(["game-paused"],"*")},t.gameLoaded=function(){e.postMessage(["game-loaded"],"*")},t.type="gamee-web"}var e=t.setTimeout,o={updateScore:function(t){},requestController:function(t){},additionalController:function(t){},gameOver:function(){},gameStart:function(){},gameLoaded:function(){},type:"no-gamee"},n=navigator.userAgent.toLowerCase();/iphone|ipod|ipad/.test(n)?window.self!==window.top?r(o):a(o):/gamee\/[0-9\.]+$/.test(n)?a(o):window.parent?r(o):window.parent&&window.parent.gameeSimulator?i(o):console.error("No gamee enviroment matched"),t.$gameeNative=o}(this);var gamee=function(t){"use strict";function a(t,e,o){t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent&&t.attachEvent("on"+e,o)}function r(t){return function(e){return e&&e.keyCode||(e||(e=window.event),e.which&&(e.keyCode=e.which)),t(e)}}var e,o=function(){},n={};return Object.defineProperty(n,"score",{get:function(){return e},set:function(o){e=o,t.$gameeNative.updateScore(e)}}),n.gameOver=function(){t.$gameeNative.gameOver()},n.gameStart=function(){t.$gameeNative.gameStart()},n.gameLoaded=function(){t.$gameeNative.gameLoaded()},n.onPause=o,n.onStop=o,n.onRestart=o,n.onMute=o,n.onUnmute=o,n.onUnpause=o,n.onResume=function(){n.onUnpause()},n._keydown=function(e){a(t,"keydown",r(e))},n._keyup=function(e){a(t,"keyup",r(e))},"gamee-web"===t.$gameeNative.type&&(n._keydown(function(t){switch(t.keyCode){case 80:n.onPause(),$gameeNative.gamePaused();break;case 82:n.onRestart()}}),a(t,"message",function(t){switch(t.data[0]){case"pause":n.onPause();break;case"resume":n.onResume();break;case"restart":window.focus(),n.onRestart();break;case"mute":n.onMute();break;case"button_button_down":n.controller.trigger("keydown",{button:"button"});break;case"button_button_up":n.controller.trigger("keyup",{button:"button"});break;case"button_left_up":n.controller.trigger("keyup",{button:"left"});break;case"button_left_down":n.controller.trigger("keydown",{button:"left"});break;case"button_right_down":n.controller.trigger("keydown",{button:"right"});break;case"button_right_up":n.controller.trigger("keyup",{button:"right"});break;case"button_up_down":n.controller.trigger("keydown",{button:"up"});break;case"button_up_up":n.controller.trigger("keyup",{button:"up"});break;case"button_down_down":n.controller.trigger("keydown",{button:"down"});break;case"button_down_up":n.controller.trigger("keyup",{button:"down"});break;case"button_a_down":n.controller.trigger("keydown",{button:"A"});break;case"button_a_up":n.controller.trigger("keyup",{button:"A"});break;case"button_b_down":n.controller.trigger("keydown",{button:"B"});break;case"button_b_up":n.controller.trigger("keyup",{button:"B"});break;default:throw Error("Unknown message")}})),n}(this);!function(t,e){"use strict";function n(t,e){var n=this;o.call(this),this._pressed=!0,this.key=t,this.keyCode=e,this.on("keydown",function(){n._pressed=!0}),this.on("keyup",function(){n._pressed=!1})}function a(){var t=this;o.call(this),this.buttons={},this.buttonAlias={},this.on("$keydown",function(e){e.button&&t.buttonAlias[e.button]&&(e.button=t.buttonAlias[e.button]),t.trigger("keydown",e)}),this.on("$keyup",function(e){e.button&&t.buttonAlias[e.button]&&(e.button=t.buttonAlias[e.button]),t.trigger("keyup",e)}),this.on("keydown",function(e){e.button&&t.buttons[e.button]&&t.buttons[e.button].trigger("keydown")}),this.on("keyup",function(e){e.button&&t.buttons[e.button]&&t.buttons[e.button].trigger("keyup")})}function i(){a.call(this),this.addButton(new n("button",32))}function r(){a.call(this),this.addButton(new n("left",37)),this.addButton(new n("right",39))}function s(){a.call(this),this.addButton(new n("A",32)),this.addButton(new n("B",17))}function l(){a.call(this),this.addButton(new n("up",38)),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("A",32))}function c(){a.call(this),this.addButton(new n("up",38)),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("down",40)),this.addButton(new n("A",32))}function u(){a.call(this),this.addButton(new n("up",38)),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("down",40)),this.addButton(new n("A",32)),this.addButton(new n("B",17))}function d(){a.call(this),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("A",32))}function p(){a.call(this),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("A",32)),this.addButton(new n("B",17))}function f(){a.call(this),this.addButton(new n("up",38)),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("down",40))}function g(){var t=this;a.call(this),this.on("$touchstart",function(e){t.trigger("touchstart",e)}),this.on("$touchend",function(e){t.trigger("touchend",e)}),this.on("$touchmove",function(e){t.trigger("touchmove",e)}),this.on("$touchleave",function(e){t.trigger("touchleave",e)}),this.on("$touchcancel",function(e){t.trigger("touchcancel",e)})}function h(){var t=this;a.call(this),this.x=0,this.y=0,this.on("$change",function(e){t.x=e.position.x,t.y=e.position.y,t.trigger("change",e)})}function m(){h.call(this),this.addButton(new n("button",32))}function $(t,e){var o,n;if(!w[t])throw new Error("Unsupported controller type, "+t);if(e=e||{},n=new w[t],e.enableKeyboard&&n.enableKeyboard(),e.buttons)for(o in e.buttons)n.remapButton(o,e.buttons[o]);return n}var o=Bullet.constructor;e.controller={requestController:function(e,o){var n=$(e,o);return t.$gameeNative.requestController(e),b=n,n},additionalController:function(e,o){var n=$(e,o);return t.$gameeNative.additionalController(e),n},trigger:function(){if(!b)throw new Error("No controller present");b.trigger.apply(b,arguments)}},n.prototype=Object.create(o.constructor.prototype),n.constructor=n,n.prototype.isDown=function(){return this._pressed},a.prototype=Object.create(o.constructor.prototype),a.constructor=a,a.prototype.addButton=function(t){this.buttons[t.key]=t},a.prototype.enableKeyboard=function(){var t,o,n={},a=this;for(t in this.buttons)o=this.buttons[t],o.keyCode&&(n[o.keyCode]=o);e._keydown(function(t){var e=n[t.keyCode];e&&(t.preventDefault(),a.trigger("keydown",{button:e.key}))}),e._keyup(function(t){var e=n[t.keyCode];e&&(t.preventDefault(),a.trigger("keyup",{button:e.key}))})},a.prototype.remapButton=function(t,e){if(e.name&&(e=e.name),!this.buttons[t])throw Error("Button "+t+" was not found in controller");this.buttonAlias[t]=e.name,this.buttons[e.name]=this.buttons[t],delete this.buttons[t]},i.prototype=Object.create(a.prototype),i.prototype.constructor=i,r.prototype=Object.create(a.prototype),r.prototype.constructor=r,s.prototype=Object.create(a.prototype),s.prototype.constructor=s,l.prototype=Object.create(a.prototype),l.prototype.constructor=l,c.prototype=Object.create(a.prototype),c.prototype.constructor=c,u.prototype=Object.create(a.prototype),u.prototype.constructor=u,d.prototype=Object.create(a.prototype),d.prototype.constructor=d,p.prototype=Object.create(a.prototype),p.prototype.constructor=p,f.prototype=Object.create(a.prototype),f.prototype.constructor=f,g.prototype=Object.create(g.prototype),g.prototype.constructor=g,h.prototype=Object.create(a.prototype),h.prototype.constructor=h,m.prototype=Object.create(h.prototype),m.prototype.constructor=m;var b,w={OneButton:i,TwoButtons:r,FourButtons:l,FiveButtons:c,SixButtons:u,FourArrows:f,Touch:g,Joystick:h,JoystickWithButton:m,TwoArrowsTwoButtons:p,TwoArrowsOneButton:d,TwoActionButtons:s}}(this,gamee);