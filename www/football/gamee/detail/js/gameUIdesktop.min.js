function transformOverlay(e,a){var t=e.innerWidth(),i=e.innerHeight(),n=$(".b_contentWrap").height(),o=$("body").width(),s=o/6.4/100,r=n/6.36/100;a&&(s=Math.min(s,r),r=s);var l=Math.round((o-t)/2),c=Math.round((n-i)/2);e.css({"-webkit-transform":"translate("+l+"px, "+c+"px) scale3d("+s+", "+r+", 1)",transform:" translate("+l+"px, "+c+"px) scale3d("+s+", "+r+", 1)"})}$("#gameeMobile").remove();var loc=window.localization;Pace.on("done",function(){$(".in-app-preloader").hide()}),foo=function(){},foo.prototype.showOverlay=function(e){$(".js-overlay").hide(),$(e).show(),$(".gameFrame").blur(),$(".js-overlayWrap").fadeIn(),$(window).focus()},foo.prototype.hideOverlay=function(){$(".js-overlayWrap").fadeOut(),$(".gameFrame").focus()};var timer=function(){this.t=null};timer.prototype.start=function(){this.t=setInterval(function(){++window.gameeUI.playTime},1e3)},timer.prototype.pause=function(){console.log("Pause timer"),clearTimeout(this.t)},timer.prototype.resume=function(){this.t=setInterval(function(){++window.gameeUI.playTime},1e3)},timer.prototype.stop=function(){clearTimeout(this.t),window.gameeUI.playTime=0};var gameeUI=function(){this.currentState="init",this.gameMode="normal",this.playTime=0,this.score=0,this.highScore=$(".js-highscore").length?parseInt($(".js-highscore").html().replace(/\s+/g,"")):0,this.gameeVer=1,this.foo=new foo,this.timer=new timer,this.playDisabled=!0,this.onboardingComplete=null,this.myPhoto=null},GameeBridge={resume:function(){isGamee2()?gameeUI.game2.resume():window.gameeUI.game.resume()},start:function(){isGamee2()?gameeUI.game2.start(!1):""},pause:function(){isGamee2()?gameeUI.game2.pause():window.gameeUI.game.pause()},restart:function(){isGamee2()?gameeUI.game2.start(!1):window.gameeUI.game.restart()}};gameeUI.prototype.init=function(e,a){console.log("GameeJS 2: init"),this.gameeVer=2,a(e)},gameeUI.prototype.gameReady=function(){console.log("GameeJS 2: ready"),this.setGameReady()},gameeUI.prototype.requestSocial=function(){console.log("GameeJS 2: Socials requested")},gameeUI.prototype.saveState=function(){console.log("GameeJS 2: save state")},gameeUI.prototype.setController=function(){this.setGameReady()},gameeUI.prototype.gameTwLink=function(e){return"https://twitter.com/share?text=Attention%20please,%20I%20have%20just%20scored%20"+e+"%20in%20"+gameGlobals.game_name+"!%20%40gameeapp%20&url="+gameGlobals.game_url},gameeUI.prototype.gameLoaded=function(){this.game=gameeGame($(".gameFrame")[0]),gameeUI.game2=gamee2Game($(".gameFrame")[0],gameeUI)},gameeUI.prototype.updateScore=function(e){var a=parseInt(e),t=e/(this.highScore/100)+"%";window.gameeUI.score=e,$(".js-score").html(a),$(".js-scoreUnderlay").height(t)},gameeUI.prototype.gameStart=function(){this.currentState="playing",this.timer.start(),this.updateScore(0),isGamee2()&&GameeBridge.start(!1)},gameeUI.prototype.gameOver=function(){var e=parseInt($(".js-score").html());this.currentState="gameOver",$(".share-tw").attr("href",this.gameTwLink(e)),$(".this-share").addClass("visible"),this.saveScore(window.gameeUI.score),isTelegram()||this.sendMixpanel(window.gameeUI.score),ga("send",{hitType:"event",eventCategory:"Game",eventAction:"Played",eventLabel:""+gameGlobals.game_name}),this.timer.stop(),$("#sidebar-ranks .items2").remove(),this.foo.showOverlay(".js-overlayOver")},gameeUI.prototype.gameRestart=function(){$(".this-share").removeClass("visible"),GameeBridge.restart()},gameeUI.prototype.gamePause=function(){this.currentState="paused",this.timer.pause(),this.foo.showOverlay(".js-overlayPaused")},gameeUI.prototype.gameResume=function(){this.currentState="playing",this.foo.hideOverlay(),this.timer.resume(),GameeBridge.resume()},gameeUI.prototype.pauseGame=function(){this.gamePause(),GameeBridge.pause(),this.timer.pause()},gameeUI.prototype.setGameReady=function(){setTimeout(function(){gameeUI.playDisabled=!1,$(".js-overlayWrap").addClass("gameReady")},400)},gameeUI.prototype.sendMixpanel=function(e){mixpanel.track("Game Played",{"game name":gameGlobals.game_name,"game genre":gameGlobals.game_genre,"game score":e,"game play time":this.playTime,source:gameGlobals.game_source,"web version":"desktop",mode:this.gameMode})},gameeUI.prototype.sendMixpanelShare=function(e,a,t,i){mixpanel.track("Web Game Shared",{type:e,screen:a,"web version":t,"game name":gameGlobals.game_name,"button variant":i})},gameeUI.prototype.saveScore=function(e){var a=window.location.pathname,t=(new Date).getTime(),i=$("#dataId").data(),n=CryptoJS.AES.encrypt(JSON.stringify({score:e,timestamp:t}),i.id,{format:CryptoJSAesJson}).toString(),o={score:e,url:a,play_time:gameeUI.playTime,hash:n};if(isFacebook()){var s=FacebookUserData.getUserData();o.app_scoped_user_id=s.app_scoped_user_id,o.user_id=s.user_id}gameeUI.sendScoreData(o)},gameeUI.prototype.sendScoreData=function(e){var a=JSON.stringify(e),t=getBotsApiUrl()+"/set-web-score-qkfnsog26w7173c9pk7whg0iau7zwhdkfd7ft3tn";$.ajax({type:"POST",url:t,data:a,success:function(e){console.log("Gamee: score saved"),(isTelegram()||isKik()||isFacebook())&&(window.gameeUI.getFullRankings(),window.gameeUI.setGameOverRankings(e),$(".js-overlayOver .rankings").show())},dataType:"json",crossDomain:!0})},gameeUI.prototype.setStartRankings=function(e){var a=e.result.ranking,t=0!=Object.keys(a.beforeMe).length?a.beforeMe:"",i=Object.keys(t).map(function(e){return t[e]}),n=i.reverse(),o=0!=Object.keys(a.afterMe).length?a.afterMe:"",s=Object.keys(o).map(function(e){return o[e]}),r=s.reverse(),l=a.me,c=a.onboardingComplete,m="",d="",p="",u="",g="",f="",v="",y="",h=Object.keys(t).length+Object.keys(o).length+1;if(window.gameeUI.getFullRankings(),window.gameeUI.onboardingComplete=c,h>3&&$(".cRankingsBtn").css("display","inline-block"),0!=Object.keys(a.afterMe).length)for(var w in r)d+='<div class="item"><div class="pic_wrap"><img src="'+addProfilePicture(r[w].profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>'+formatUsername(r[w].username)+'</span></div><div class="points">'+r[w].score+"</div></div>";if(0!=Object.keys(a.me).length){var k;isFacebook()?k=window.gameeUI.myPhoto:l.profile_picture&&(k=l.profile_picture),meRankTpl='<div class="item me"><div class="pic_wrap"><img src="'+addProfilePicture(k)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>Me</span></div><div class="points">'+(l.score?l.score:"-")+"</div></div>"}if(2>=h?($(".rankings .headline").html(loc.youVsFriend),$(".rankings .headline").addClass("text-center"),1===h&&(p='<div class="item vs">vs</div>'),0===Object.keys(a.beforeMe).length&&1===Object.keys(a.afterMe).length&&(g='<div class="item vs">vs</div>',f=meRankTpl,meRankTpl=""),1===Object.keys(a.beforeMe).length&&0===Object.keys(a.afterMe).length&&(u='<div class="item vs">vs</div>')):$(".rankings .headline").html(loc.leaderboards),(1===h||3===h)&&(v+='<div class="item friend challenge-friends '+onPlatform()+'"><div class="pic_wrap"><img src="../detail/assets/svg/rankings-icn-empty-user.svg" class="pic" /></div><div class="username"><span>Friend</span></div><div class="points">-</div></div>'),0!=Object.keys(a.beforeMe).length){c===!1&&(y="steve");for(var w in n)m+='<div class="item '+y+'"><div class="pic_wrap"><img src="'+addProfilePicture(n[w].profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>'+formatUsername(n[w].username)+'</span></div><div class="points">'+n[w].score+"</div></div>"}$(".startRankings .rankings .items").append(f+g+d+meRankTpl+u+m+p+v),$(".startRankings .rankings").addClass("visible")},gameeUI.prototype.setGameOverRankings=function(e){var a=e.result.ranking,t=0!=Object.keys(a.beforeMe).length?a.beforeMe:"",i=Object.keys(t).map(function(e){return t[e]}),n=i.reverse(),o=0!=Object.keys(a.afterMe).length?a.afterMe:"",s=Object.keys(o).map(function(e){return o[e]}),r=s.reverse(),l=a.me,c="",m="",d="",p="",u="",g="",f="",v=Object.keys(t).length+Object.keys(o).length+1;if($(".rankings .items .item").remove(),0!=Object.keys(a.afterMe).length)for(var y in r)m+='<div class="item"><div class="pic_wrap"><img src="'+addProfilePicture(r[y].profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>'+formatUsername(r[y].username)+'</span></div><div class="points">'+r[y].score+"</div></div>";if(0!=Object.keys(a.me).length&&(meRankTpl='<div class="item me"><div class="pic_wrap"><img src="'+addProfilePicture(l.profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>Me</span></div><div class="points">'+(l.score?l.score:"-")+"</div></div>"),2>=v?($(".rankings .headline").html(loc.youVsFriend),$(".rankings .headline").addClass("text-center"),1===v&&(d='<div class="item vs">vs</div>'),0===Object.keys(a.beforeMe).length&&1===Object.keys(a.afterMe).length&&(p='<div class="item vs">vs</div>',g=meRankTpl,meRankTpl=""),1===Object.keys(a.beforeMe).length&&0===Object.keys(a.afterMe).length&&(u='<div class="item vs">vs</div>')):$(".rankings .headline").html(loc.leaderboards),(1===v||3===v)&&(f+='<div class="item friend challenge-friends '+onPlatform()+'"><div class="pic_wrap"><img src="../detail/assets/svg/rankings-icn-empty-user.svg" class="pic" /></div><div class="username"><span>Friend</span></div><div class="points">-</div></div>'),0!=Object.keys(a.beforeMe).length)for(var y in n)c+='<div class="item"><div class="pic_wrap"><img src="'+addProfilePicture(n[y].profile_picture)+'" class="pic" onerror="this.style.display=\'none\'" /></div><div class="username"><span>'+formatUsername(n[y].username)+'</span></div><div class="points">'+n[y].score+"</div></div>";$(".js-overlayOver .rankings .items").append(g+p+m+meRankTpl+u+c+d+f),$(".js-overlayOver .rankings").addClass("visible")},gameeUI.prototype.setFullRankings=function(e){var a=e.result.ranking,t=null===e.result.myRank?"0":e.result.myRank,i=e.result.membersCount;$(".js-overlayOver .membersCount").html(i),$(".js-overlayOver .myPosition").html(t+nth(t)),$("#sidebar-ranks .items .row").remove();for(var n in a){var o=a[n].rank===t?"me":"",s='<div class="avatar"><div class="img-wrap"><img src="'+addProfilePicture(a[n].profile_picture)+'" class="pic" onerror="this.src=\'../detail/assets/png/avatar-placeholder.png\';" /></div></div>';$("#sidebar-ranks  .items").append('<div class="row '+o+'"><div class="line"><div class="number">'+a[n].rank+".</div>"+s+'<div class="name">'+htmlspecialchars(a[n].username)+'</div><div class="points">'+a[n].score+"</div></div></div>")}},gameeUI.prototype.getFullRankings=function(){var e=window.location.pathname,a={url:escape(e)};isFacebook()&&(a.facebook_user_id=FacebookUserData.getUserData().app_scoped_user_id);var t=getBotsApiUrl()+"/api/game-url-ranking";$.ajax({type:"GET",url:t,data:a,xhrFields:{withCredentials:!0},success:function(e){console.log("Game: requested rankings"),window.gameeUI.setFullRankings(e)},beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa("web-api:1k2tnlowfvzfjursfhf523fuenc1guzwxfq8jgc8"))},error:function(e,a){},dataType:"json",crossDomain:!0})},gameeUI.prototype.setFullRankingsPopup=function(e){var a=e.result.ranking,t=null===e.result.myRank?"0":e.result.myRank,i=e.result.membersCount;if($("#overlay-standing .membersCount").html(i),$("#overlay-standing .myPosition").html(t+nth(t)),$("#overlay-standing .items .row").remove(),Object.keys(a).length>0)for(var n in a){var o=a[n].rank===t?"me":"";$("#overlay-standing .items").append('<div class="row '+o+'"><div class="line"><div class="number">'+a[n].rank+'.</div><div class="pic_wrap"><div class="pic_in"><img src="'+addProfilePicture(a[n].profile_picture)+'" class="pic" onerror="this.src=\'../detail/assets/png/avatar-placeholder.png\';" /></div></div><div class="name"><span>'+htmlspecialchars(a[n].username)+'</span></div><div class="points">'+a[n].score+"</div></div></div>")}},gameeUI.prototype.getFullRankingsPopup=function(){var e=window.location.pathname,a={url:escape(e)};isFacebook()&&(a.facebook_user_id=FacebookUserData.getUserData().app_scoped_user_id);var t=getBotsApiUrl()+"/api/game-url-ranking";$.ajax({type:"GET",url:t,data:a,xhrFields:{withCredentials:!0},success:function(e){console.log("Game: requested rankings"),window.gameeUI.setFullRankingsPopup(e)},beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa("web-api:1k2tnlowfvzfjursfhf523fuenc1guzwxfq8jgc8"))},error:function(e,a){},dataType:"json",crossDomain:!0})},gameeUI.prototype.getStats=function(){var e=window.location.pathname,a={url:escape(e)};if(isFacebook()){var t=this;FacebookUserData.addAfterLoginCallback(function(){a.facebook_user_id=FacebookUserData.getUserData().app_scoped_user_id,FacebookUserData.isLoggedIn()?t.getSurroundingRankings(a):($("#sidebar-ranks .ranks-wrap").hide(),$(".msg-wrap.fb-connect").css("display","table"))})}else this.getSurroundingRankings(a)},gameeUI.prototype.getSurroundingRankings=function(e){var a=getBotsApiUrl()+"/api/game-url-surrounding-ranking";$.ajax({type:"GET",url:a,data:e,success:function(e){isEmpty(e.result.ranking)||(window.gameeUI.setStartRankings(e),$(".js-overlayPlay .rankings").show())},xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa("web-api:1k2tnlowfvzfjursfhf523fuenc1guzwxfq8jgc8"))},error:function(e,a){},crossDomain:!0})},window.gameeUI=new gameeUI,$(window).on("keypress",function(e){(0==e.keyCode||32==e.keyCode)&&("init"==window.gameeUI.currentState&&gameeUI.playDisabled===!1?($(".js-overlayPlay").addClass("this-triggered"),window.gameeUI.foo.hideOverlay(),gameeUI.gameStart(),setTimeout(function(){$(".js-overlayPlay").removeClass("this-triggered")},1e3)):"playing"==window.gameeUI.currentState||("paused"==window.gameeUI.currentState?window.gameeUI.gameResume():"gameOver"==window.gameeUI.currentState&&(window.gameeUI.foo.hideOverlay(),GameeBridge.restart()))),(114===e.keyCode||82===e.keyCode)&&"gameOver"==window.gameeUI.currentState&&(window.gameeUI.foo.hideOverlay(),GameeBridge.restart())}),$(".child-pushSpace").on("click",function(e){console.log("Space pressed."),"init"==window.gameeUI.currentState&&gameeUI.playDisabled===!1?($(".js-overlayPlay").addClass("this-triggered"),window.gameeUI.foo.hideOverlay(),gameeUI.gameStart(),setTimeout(function(){$(".js-overlayPlay").removeClass("this-triggered")},1e3)):"playing"==window.gameeUI.currentState||("paused"==window.gameeUI.currentState?window.gameeUI.gameResume():"gameOver"==window.gameeUI.currentState&&(window.gameeUI.foo.hideOverlay(),GameeBridge.restart()))}),$(".js_resume").on("click",function(e){window.gameeUI.gameResume()});var overlayEmbed=$(".overlay-embed"),clipboard=new Clipboard(".btn-copy");clipboard.on("success",function(e){$("#game_url").css("border-color","#5ac546"),$(".btn-copied").css("display","block"),$(".btn-copy").css("display","none"),setTimeout(function(){$(".btn-copied").css("display","none"),$(".btn-copy").css("display","block")},4e3),e.clearSelection()}),$(".btn-embed-game").on("click",function(e){overlayEmbed.addClass("visible"),setTimeout(function(){document.getElementById("game_url").select()},500)}),$(".close-popup").on("click",function(e){$(this).parents(".overlay").removeClass("visible"),$("#game_url").css("border-color","#b1c1c3")}),$(".preloader.main").hide(),$(window).on("load",function(){var e=$(".gameFrame");window.gameeUI.gameLoaded(),e.attr("src",e.data("src")),isBot()?window.gameeUI.getStats():($("#sidebar-ranks .ranks-wrap").hide(),$(".msg-wrap.fb-connect").css("display","table")),$("html").addClass("this-loaded"),window.innerWidth<640&&transformOverlay($(".b_contentWrap"),!0),window.addEventListener("resize",function(){document.body.offsetWidth<640?transformOverlay($(".b_contentWrap"),!0):($(".b_contentWrap").css({"-webkit-transform":"none",transform:"none"}),$("#gameeDesktop #overlay-standing").removeClass("visible"))})}),$(".js_pause").on("click",function(){window.gameeUI.pauseGame()}),$(".js_restart").on("click",function(){window.gameeUI.gameRestart()}),$(".cRankingsBtn").on("click",function(e){e.preventDefault(),$("#gameeDesktop #overlay-standing").addClass("visible"),window.gameeUI.getFullRankingsPopup()}),$(".cRankingsBtn_close").on("click",function(e){e.preventDefault(),$("#gameeDesktop #overlay-standing").removeClass("visible")}),$(".this-share a, .js_shareFB, .js_shareTW, .twitter-share-button, .fb-like, .share-telegram").on("click",function(e){var a=$(this).data("screen"),t=$(this).data("type"),i=$(this).data("version"),n=1;window.gameeUI.sendMixpanelShare(t,a,i,n)}),$(".on-fb").on("click",function(e){var t=($("body").attr("data-bot-deep-link-base"),$("body").data("facebook-bot-app-id"));FB.ui({method:"send",app_id:t,link:gameGlobals.game_fullUrl})}),$(document).on("click",".challenge-btn.on-telegram, .share-telegram",function(e){TelegramGameProxy.shareScore()}),$(".re-request-friends-permission, .action-fb-connect").on("click",function(e){e.preventDefault(),FacebookUserData.forceConnect()});